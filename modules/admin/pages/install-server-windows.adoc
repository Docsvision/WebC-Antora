= Установка серверного расширения на Windows

[#windows]
Пользователь, выполняющий установку, должен обладать правами администратора.

.Чтобы установить серверное расширение {wc}:
. *Запустите пакет установки* `{dv} web-client server extension.msi`.
+
. *Примите условия лицензионного соглашения*, чтобы продолжить установку.
+
.Условия лицензионного соглашения
image::install-server-license.png[Условия лицензионного соглашения]
+
// . Установите или обновите необходимые модули, если проверка не пройдена. xref:ROOT:requirements-dv.adoc#checkVersions[Подробнее] о проверке.
// +
// .Проверка требуемых модулей
// image::install-server-check.png[Проверка требуемых модулей]
// +
. Если требуется, измените каталог установки Расширения.
+
.Каталог установки Расширения
image::install-server-location.png[Каталог установки Расширения]
+
. Выберите необходимые компоненты установки.
+
.Выбор компонентов
image::install-server-components.png[Выбор компонентов]
+
// tag::components[]
* Компоненты {wc}а -- компоненты, необходимые для работы {wc}а. Обязательны к установке, неотключаемы.
* [[archive]]Компоненты Управления Архивом -- компоненты, открывающие возможность работы с функциями модуля _{am}_ в {wc}е. Обязательны к установке, если планируется работа с модулем _{am}_. Компоненты недоступны для установки, если не установлен модуль _{am}_.
+
NOTE: Работа с модулем _{am}_ версии 5.5.1 не поддерживается в данной версии {wc}а.
+
ifdef::client[]
* {kvr} -- компоненты программы для работы с Web-разметками {kvr} может быть установлен вместе с сервером {wc}а и/или на отдельный компьютер (см. xref:install-server-windows.adoc[Отдельная установка программы {kvr}]).
endif::client[]
* [[edi]]Компоненты модуля интеграции с операторами ЭДО -- компоненты {wc}а, необходимые для работы с модулем _{em}_.
+
Компоненты отображаются только если установлен _{em}_ версии {edi-v} и выше.
// end::components[]
+
. Нажмите на кнопку *Установить* и дождитесь завершения установки Расширения.
+
.Установка Расширения
image::install-server-confirm.png[Установка Расширения]
+
// . В процессе установки появится окно выбора БД. Выберите базы данных {dv}, в которые будет установлено расширение {wc}.
// +
// .Окно выбора баз данных для установки расширения
// image::install-db.png[Окно выбора баз данных для установки расширения]
// +
// Выберите все базы данных, к которым будет подключен {wc}, и нажмите кнопку *ОК*. База данных по умолчанию выделена жирным шрифтом.
// +
// [WARNING]
// ====
// * Если модуль устанавливается впервые и настройки ещё не были загружены в БД, в диалоге выберите *Отмена*.
// * {blank}
// +
// --
// include::partial$excerpts.adoc[tags=nonoyet]
// --
// ====
// +
// Дождитесь завершения установки расширения.
// +
// . Согласитесь с перезапуском сервисов {dv} при поступлении запроса.
// +
// .Диалог перезапуска сервисов {dv}
// image::install-restart-services.png[Диалог перезапуска сервисов {dv}]
// +
. Нажмите кнопку *Готово* для завершения работы мастера установки.
. Обновите БД через {cns}, подробнее процесс описан в документации модуля {pl}, раздел "xref:6.1@platform:console:db-update.adoc[]".

[#kvr-pu]
== Установка программ {kvr} и Панель управления

{kvr} и {pu} устанавливаются из пакета установки {wc}а.

[NOTE]
====
Системные требования приведены в пункте xref:ROOT:separate-layouts-install.adoc[Требования отдельной установки программы {kvr}].
====

Пользователь, выполняющий установку, должен обладать правами локального администратора.

.Чтобы установить {kvr}:
. Добавьте данные системной учётной записи {dv} в переменные окружения (если это не было выполнено ранее). +
Под этой учётной записью {kvr} и {pu} будут подключаться к серверу {dv}.
+
 setx DV_SystemUserAccount account@domain.com
 setx DV_SystemUserPassword password
+
. Запустите пакет установки `{dv} web-client.msi`.
. Примите условия лицензионного соглашения, чтобы продолжить установку.
. Если требуется, измените каталог установки.
+
.Каталог установки {wc}а
image::install-client-location.png[Каталог установки {wc}а]
+
. Выберите для установки все компоненты {wc}а.
+
.Устанавливаемые компоненты модуля {wc}
image::install-client-components.png[Устанавливаемые компоненты модуля {wc}]
// image::install-client-components-layouts.png[Устанавливаемые компоненты модуля {wc}]
// +
// . Укажите адрес подключения к StorageServer в формате `\http://имя-сервера/DocsVision`) и псевдоним БД {dv}, затем нажмите *Далее*.
// +
// .Настройки подключения к {dv}
// image::install-layouts-settings.png[Настройки подключения к {dv}]
// +
+
. Укажите адрес подключения к серверу {dv} в файлах конфигурации:
+
* `WebClientAdminConsole.appsettings.json` -- конфигурация программы _{pu}_.
* `WebLayoutsDesigner.appsettings.json` -- конфигурация программы _{kvr}_.
+
[source,json]
----
{
  "Docsvision": {
    "WebClient": {
      "Server": {
        "SessionManagerConnection": {
          "ConnectionAddress": "http://dvserver.domain.com:5000", <.>
          "BaseName": "alias" <.>
        }
      }
    }
  }
}
----
<.> Адрес сервера {dv}.
<.> Псевдоним БД для подключения.
+
. Нажмите кнопку *Установить* и дождитесь завершения установки {wc}а.
+
В меню Пуск в группу {dv} будут добавлены ярлыки: {kvr} и {pu}.
+
. Откройте {pu} на вкладке _Решения_ и выполните импорт стандартных решений для корректной работы {wc}а.
