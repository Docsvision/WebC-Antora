
== Взаимодействие Web-клиента с программой «DVWebTool»

Программа «DVWebTool» предоставляет Web-клиенту доступ к окружению пользователя: установленным программам, локальным и сетевым устройствам.

Программа «DVWebTool» является сервисом, который выполняется на пользовательском компьютере и предоставляет возможность запускать определенные процессы с правами *текущего пользователя* Windows.

Взаимодействие компонентов организовано следующим образом:

. Пользователь Web-клиента инициирует операцию, для выполнения которой необходим запуск процессов на компьютере пользователя, например: вызов Microsoft Word для автоконсолидации версий документа.
. Веб-браузер пользователя подключается по локальному адресу к порту 5413, который по умолчанию прослушивает программа «DVWebTool». Подключение осуществляется по протоколу WebSocket.
. Веб-браузер вызывает требуемую функцию программы «DVWebTool», например: запуск Microsoft Word в режиме автоконсолидации документа.
. Программа «DVWebTool» выполняет требуемую задачу.

image::dvWebToolSchema.png[[.fig--title-label]##Figure 1. ##Схема взаимодействия программы «DVWebTool» с другими компонентами]

Программа «DVWebTool» обеспечивает базовые функции взаимодействия с веб-браузером; функции для работы с окружением реализованы в расширениях программы. Расширения «DVWebTool» могут вызывать функции установленных на компьютере пользователя программ и устройств, или выполнять другие операции (например, взаимодействовать с сетевыми ресурсами). Для реализации новых функций могут быть разработаны собственные расширения.

=== Алгоритм работы при создании объединенной версии согласуемого документа

Указанный далее алгоритм описывает механизм создания объединенной версии согласуемого документа при вызове данной функции пользователем.

. Из клиентской части Web-клиента в программу «DVWebTool» передается идентификатор карточки для консолидации.
. Программа «DVWebTool» получает с сервера файлы для консолидации и средствами Microsoft Word выполняет слияние файлов. Результат передается на сервер.

Для работы данного алгоритма важно, чтобы Web-клиент и программа «DVWebTool» были запущены от имени одного сотрудника.

=== Алгоритм работы при сканировании

. Из клиентской части Web-клиента в программу «DVWebTool» передается запрос на сканирование с параметрами сканирования.
. Программа «DVWebTool» обращается к сканеру, получает с него результат и передаёт клиенту.

*Parent topic:* xref:../topics/DvWebToolWithBrowser.html[Связь между составными частями программы]
