= Личный Кабинет сотрудника кадрового электронного документооборота (ЛК КЭДО)

Решение для личного кабинета сотрудника кадрового документооборота содержит ограниченную функциональность (по сравнению со стандартной версией {wc}а). Решение состоит из интерфейса сотрудника и стандартного интерфейса. Решение предназначено для сотрудников, не имеющих постоянного взаимодействия с системой {dv}, которые не нуждаются в обучении.

.Стартовый экран решения КЭДО
image::kedo-screen.png[Стартовый экран решения КЭДО]

[#description]
== Функции решения

Для сотрудника предусмотрен минималистичный внешний вид и набор функций:

* Меню скрыто.
* Существует возможность создать только выбранные виды документов.
* Скрыт поиск документов по штрихкоду.
* На главной странице ограничено количество папок, оставлены только обязательные:
** Папку с заданиями на подписание КЭДО.
** Папку с заданиями на ознакомление.
** Папку с заявками сотрудника.
** Папку с кадровыми документами в состоянии "Действует".
* Сотрудники имеют возможность создавать карточки вида _Заявки сотрудника_.
* Количество представленных данных в профиле сотрудника сокращено.

.Для работы с решением предусмотрены следующие группы пользователей:
* _Cпециалисты по КЭДО_ -- сотрудники, являющиеся специалистами по HR, связанные с ролью _Кадровик_. Для специалиста все разметки имеют полную функциональность.
* _Сотрудники КЭДО_ -- сотрудники, не являющиеся специалистами HR или руководителями, связанные с ролью _Сотрудник_ и _Сотрудник ЛК КЭДО_. Для сотрудника интерфейс главной страницы настроен в конструкторе разметок на общую роль _Сотрудник ЛК КЭДО_.
* _Руководители_ -- сотрудники, являющиеся руководителями. Для руководителя разметки в подписании КЭДО имеют частично ограниченную функциональность.

[#requirements]
== Требования для запуска решения

.Для работы решения требуется:
* Модуль {bo} версии 5.5.5, сборка 8650 и выше.
* Модуль {wc} версии 5.5.17, сборка 6478 и выше.
* Visual Studio {vscode-v} и выше.
* NodeJS {node-v} и выше.

[#sample]
== Описание примера

.Пример включает следующие компоненты:
* menu:Data[KEDO.sol] -- В данном решении используется несколько видов карточек дочерних от видов Документ и Задания, и обладающих своими настройками. В родительском виде _Документ_ есть подвид _КЭДО_, содержащий _Кадровый документ_ и _Заявки сотрудника_.
+
** Карточка _Кадровый документ_ -- создается HR-специалистом для отправки руководителю и сотруднику на подписание. В кадровом документе HR-специалист заполняет поля вида кадрового документа, выбирает компанию, сотрудника, руководителя и прикладывает файл для согласования. Далее _Кадровый документ_ отправляется на подписание сотруднику и руководителю.
** Карточка _Заявка сотрудника_ формируется _Сотрудником КЭДО_ из личного кабинета. Сотрудник заполняет вид заявки и название. Возможно добавить файл и примечание. Далее при помощи "xref:layouts:ctrl/system/stateButtons.adoc[ЭУ Автомат состояния]" файл попадает в папку "Заявки от сотрудников", которая видна HR.
** В родительском виде _Задание_ есть подвид _Подписание КЭДО_. При помощи этой карточки данного вида формируются задание на подписание для сотрудника, руководителя и HR-специалиста.
+
* menu:Data[KEDOSolution] -- папка с решением, включающим web-разметки для личного кабинета сотрудника КЭДО.
* menu:Extensions[KEDOWebExtension] -- папка с клиентским расширением, в котором реализованы скрипты для добавления приветствия в личный кабинет сотрудника и ограничения функционала электронной подписи для сотрудников из группы _Сотрудники КЭДО_.
* menu:Extensions[CustomTablesWebExtension] -- папка с клиентским расширением, содержит клиентский скрипт и стили для элемента управления _SampleCustomTables_.
* menu:Extensions[CustomTablesDesignerExtension] -- папка с расширением для программы {kvr}, содержит описание элемента управления `_SampleCustomTables_`.
* `Images` -- папка с иконками для личного кабинета сотрудника КЭДО.
* `Styles` -- папка со стилями для личного кабинета сотрудника КЭДО.
** `add-style.button.css` -- стили, назначающие серый цвет, для кнопок в заданиях На подписание КЭДО.
** `fix-layout.css` -- стили для главной страницы личного кабинета Сотрудника КЭДО.
** `UrlButton.css` -- стили для кнопки создания заявки в личном кабинете сотрудника.

.Элемент управления "SampleCustomTables":
* Элемент управления `_SampleCustomTables_` содержит базовый функционал ЭУ `_Виджет / Карточки папки_` (`_folderCardsDashboardWidget_`) с дополнительными параметрами:
** Изменение наименования ссылки под таблицей.
** Добавление счетчика документов, заданий, заявок.
** Дополнительная кнопка с заданной ссылкой и наименованием.

[#assembly]
== Сборка примера

. Откройте `Samples.sln` и соберите проект `SampleCustomTablesDesignerExtension`.
. Соберите клиентские расширения:
+
* Откройте командную строку и перейдите в текущую директорию.
* Выполните команду `.\install.ps1 3`.
* Дождитесь завершения сборки клиентских расширений.
+
. Скопируйте каталог menu:SamplesOutput[Plugins > SampleCustomTablesDesignerExtension] в menu:Каталог-установки-{wc}а[Plugins]
. Скопируйте каталог menu:SamplesOutput[Site > Content > Modules > KEDO] в menu:Каталог-установки-{wc}а[Site > Content > Modules].

[#test]
== Проверка примера

. Импортируйте решение "КЭДО", menu:Data[KEDO.sol] через {sm}.
+
.Решение включает следующие компоненты:
* Справочник видов:
** _Документ -- КЭДО -- Кадровый документ, Заявки сотрудника_.
** _Задание -- Задание КС -- На подписание КЭДО_.
* Роли:
+
** Роли для вида _Кадровый документ_:
*** _Кадровик_ -- самый полный доступ ко всем операциям.
*** _Работодатель_ -- ограниченные права на просмотр истории, на удаление и редактирование регистрационных данных.
*** _Сотрудник_ -- доступ к подписанию и изменению файла.
** Роли для вида _Заявки сотрудника_, дочернего от вида _Заявки УД_:
*** _HR_ -- полные права на редактирование карточек в состоянии "обрабатывается в отделе кадров", а также права на чтение в любом состоянии.
*** _Все руководители_ -- не обладают правами на изменение в состояниях `Завершено` и `Отозвано`, не обладают правами на просмотр истории.
*** _Делегировавший_ -- обладают правами на сохранение по умолчанию, как в родительском виде.
*** _Исполнитель_ -- не обладают правами: на добавление комментария, на изменение или удаление своего комментария, на просмотр дополнительных полей, на делегирование задания, редактирование параметров исполнения и на создание подчиненного задания.
** Общая роль _Сотрудник ЛК КЭДО_. Роль создана для отображения интерфейса личного кабинета Сотрудника.
+
* Метаданные: _Кадровые документы_: _Руководитель_, _HR_, _Сотрудник КЭДО_, _Виды кадровых документов_.
* Конструктор правил нумерации: _Кадровый документ_.
* Конструктор справочников: _Кадровые документы_, _Заявка сотрудника_.
* Поиск: _КЭДО_ и все подчиненные поисковые запросы, содержатся в папке `КЭДО`.
* Представление: _КЭДО_ и все подчиненные, располагаются в папке `КЭДО`.
* Папки: _КЭДО_ и подчиненные:
** Виртуальная папка _Заявки от сотрудников_ для HR-специалистов.
** Папка _КЭДО сотрудника_ для хранения маршрутов согласования и подчиненные папки для личного кабинета сотрудника.
+
. Импортируйте решение _КЭДО_ через {kvr}. Выберите файл `Solution.xml` в папке решения menu:Data[KEDOSolution].
. Чтобы визуализация ЭП и штрихкода работала корректно, убедитесь что в `root` разметки _Задания на подписание КЭДО_ обработчик события `*Разметка для просмотра заданий на ознакомление сотрудником*` назначено `signature`.
. Добавьте сотрудников, являющихся руководителями в группу _Руководители_.
. Добавьте сотрудников, которым необходим доступ к личному кабинету в группу _Сотрудники КЭДО_ в справочнике сотрудников.
. Добавьте сотрудников кадрового документооборота в группу _Cпециалисты по КЭДО_ в справочнике сотрудников.
. В справочнике видов карточек настройте согласование для видов карточек Кадровый документ с типом _Согласование_ и видом _Усовершенствованное согласование_.
+
Заполните названия _Первый подписывает сотрудник_ и _Первый подписывает работодатель_, способ создания _Создание согласования_, вид родительской карточки _Кадровый документ_. затем выберите соответствующие шаблоны из папки _КЭДО сотрудника_.

шаблон - выбрать соответствующий маршрут из папки "КЭДО сотрудника".
+
****
При отправке на согласование кадровых документов, _Кадровик_ выбирает один из двух маршрутов в зависимости от потребностей или вида кадрового документа.

Первый подписывает работодатель::
На первом этапе документ отправляется на согласование. Данный этап не является обязательным, его можно исключить из согласования.
+
На втором этапе документ подписывает работодатель.
+
На третьем этапе документ подписывает сотрудник.
+
На четвертом этапе _Кадровик_ подписывает документ, переводя его в состояние `Действует`. Результаты этапа кадровика не входит в лист согласования.

Первый подписывает сотрудник::
На первом этапе документ отправляется на согласование. Данный этап не является обязательным, его можно исключить из согласования.
+
На втором этапе документ подписывает сотрудник.
+
На третьем этапе документ подписывает работодатель.
+
На четвертом этапе _Кадровик_ подписывает документ, переводя его в состояние `Действует`. Результаты этапа кадровика не входит в лист согласования.


****
+
. В {wc}е добавьте папку для специалистов по КЭДО. menu:Главное меню[Настроить > Добавить папку > КЭДО > Заявки от сотрудников].
+
.Структура папок решения представлена следующим образом:
* Родительская папка `КЭДО`
* Подпапка `Заявки от сотрудников` -- для специалистов КЭДО, в папку попадают заявки сотрудников.
* Подпапка `КЭДО сотрудника` -- содержит маршруты и этапы согласования, а также виртуальные подпапки.
** Документы на подписание.
** Документы для ознакомления.
** Мои документы.
** Мои заявки.
** Поиск кадровых документов.

