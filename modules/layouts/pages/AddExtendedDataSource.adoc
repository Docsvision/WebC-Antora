
== Подключение дополнительных источников данных

При настройке разметки по умолчанию предоставляется доступ только к данным текущей карточки, т. е. элементы управления, позволяющие отображать и/или изменять данные карточки, могут работать только с секциями и полями данной карточки.

Если требуется, к разметке можно подключить дополнительные источники данных (карточки, связанные с текущей), с которыми смогут работать элементы разметки.

. Откройте разметку карточки или справочника.
. Выберите xref:Control_layout.adoc[корневой элемент управления разметки].
. Нажмите кнопку image:buttons/bt_dots.png[image] в свойстве [.dfn .term]_Расширенные источники данных_. Будет открыто окно [.ph .uicontrol]*Расширенные источники данных*.
+
image::extDataSouceConfigEmpty.png[[.fig--title-label]##Figure 1. ##Настройка дополнительных источников данных]
. Нажмите кнопку [.ph .uicontrol]*Добавить*. В список источников будет добавлен новый источник.
+
image::extDataSouceConfigWithAddedSource.png[[.fig--title-label]##Figure 2. ##Дополнительные источники с добавленным источником]
. В поле «Тип источника данных» выберите тип связанной карточки, которая будет выступать источником дополнительных данных.
+
Типы источников:
+
* Для всех локаций:
** «Ссылка из поля карточки» – источником данных выступает любая карточка, на которую ведёт ссылка из поля текущей карточки. В параметрах получения источника (см. ниже) нужно выбрать поле текущей карточки, содержащее ссылку на карточку, которая будет являться дополнительным источником данных. Данный тип источника может использоваться в любых карточках и справочниках.

* Для локаций карточек:
** «Согласуемый документ» – источником данных выступает Документ, по которому выполняется согласование. Данный тип источника должен использоваться только в разметках карточек Заданий согласования.
** «Документ для Задания» – источником данных выступает Документ, связанный с заданием (выбирается из списка ссылок). В параметрах получения источника (см. ниже) можно выбрать тип ссылки, указывающей на Документ. Если в списке ссылок несколько карточек Документ с выбранным типом ссылок, дополнительным источником будет выбрана первая найденная карточка. Данный тип источника может использоваться в разметках карточек Задание и Группа Заданий.
** «Связанная карточка ГЗ» – источником выступает Группа заданий из списка ссылок карточки Задание. В параметрах получения источника (см. ниже) нужно выбрать тип ссылки, указывающей на Группу заданий. Если в списке ссылок несколько карточек Группа заданий с выбранным типом ссылок, дополнительным источником будет являться первая найденная карточка. Данный тип источника предназначен для разметок карточек Задание.
+
[NOTE]
====
[.note__title]#Note:# Для получения данных из родительской группы заданий нужно выбрать тип ссылки «Связанные карточки».
====
* Для локации «Диалог профиля пользователя»:
** «Карточка текущего пользователя» – получает данные из карточки сотрудника;
** «Строка справочника текущего пользователя» – получает данные из Справочника сотрудников из строки пользователя.
. Настройте параметры получения дополнительного источника данных. Не требуется для типа «Согласуемый документ».
[loweralpha]
.. Нажмите кнопку [.ph .uicontrol]*Установить параметры*.
.. Установить параметры получения источника данных:
* для типа «Документ для Задания» – выберите тип ссылки на Документ, который будет являться источником данных;
* для типа «Ссылка из поля карточки» – выберите поле текущей карточки, содержащее ссылку на карточку, которая будет являться источником данных.
.. Нажмите кнопку [.ph .uicontrol]*ОК* для сохранения настроек. В поле «Наименование» будет записано название нового типа источника данных (не редактируемое).
. Если требуется, включите асинхронную загрузку данных из связанной карточки.
+
По умолчанию данные связанной карточки получаются синхронно при открытии текущей карточки. Для включения асинхронного режима снимите флаг [.ph .uicontrol]*Загружать синхронно*. Элементы управления, получающие данные из асинхронного источника, загружаются асинхронно.
. Нажмите кнопку [.ph .uicontrol]*ОК* в окне [.ph .uicontrol]*Расширенные источники данных* для настроек.

При настройке элемента управления разметки, поддерживающего получение данных из дополнительных источников (есть свойство «Расширенный источник данных»), добавленный источник выбирается по имени, которое отображается в поле «Наименование» в окне [.ph .uicontrol]*Расширенные источники данных*.

