= Ссылки

Элемент управления `_Ссылки_` предназначен для работы со списком ссылок карточки.

NOTE: Элемент управления всегда работает в режиме редактирования по месту как в разметке редактирования, так и в разметке просмотра. Это значит, что добавленная ссылка сохранится всегда, даже если изменения в карточке не были сохранены.

Вариант отображения ЭУ, а также его функциональные возможности зависят от свойства `_Режим отображения_`, которое может иметь значение *_по умолчанию_* или *_простой_*.

.Пример отображения элемента управления "Ссылки" в режиме По умолчанию
image::linkListSample.png[Пример отображения элемента управления "Ссылки" в режиме По умолчанию]

ЭУ в режиме *_По умолчанию_* позволяет:

* Просматривать список существующих ссылок.
* Добавлять ссылки на существующие карточки с использованием формы поиска и выбора карточки.
+
.Выбор ссылки на карточку
image::linksSelectCard.png[Выбор ссылки на карточку]
+
* Создавать новые с добавлением ссылок.
* Добавлять гиперссылки.
* Добавлять файлы.
* Ограничивать возможность добавления ссылок.
* Просматривать информацию о ссылке и добавлять описание к ней.

Возможность выполнения определенной операции со списком ссылок определяется доступностью соответствующей операции согласно ролевой модели.

.Пример отображения элемента управления "Ссылки" в режиме "Простой"
image::linkListSimple.png[Пример отображения элемента управления "Ссылки" в режиме "Простой"]

ЭУ в режиме *_Простой_* позволяет:

* Просматривать список существующих ссылок.
* Просматривать информацию о ссылке и добавлять описание к ней.

[#reference]
[NOTE]
====
Описание ссылки в таблице ссылок, а также справка о ссылке могут быть настроены. См. пункт xref:ctrl/special/linksLinkDescription.adoc[Настройка отображения информации о ссылке в элементе управления Ссылки].

К карточкам, ссылки на которые содержатся в ЭУ, могут применяться групповые операции. См. пункт xref:ctrl/special/linksBatchOperations.adoc[Настройка групповых операций в элементе управления Ссылки].
====

== Свойства

include::partial$properties.adoc[tags=general]

=== Внешний вид

==== Вид дополнительной информации

Определяет способ формирования справки о ссылке (открывается при нажатии кнопки image:buttons/linkInfo.png[Информация]):

* *_Только о ссылке_*. В справке будут отображаться: автор ссылки, тип ссылки и описание.
* *_Только о карточке_*. В справке будет отображаться информация о карточке, на которую указывает ссылка. Формат отображения информация о карточке определяется разметкой с режимом <<reference,"Справка">>.
* *_О карточке и о ссылке_*. В справку будут включены информация о ссылке и о карточке (настраивается разметкой), на которую указывает ссылка.
* *_Не показывать_*. Не показывать кнопку для открытия справки.

.Отображение информации о ссылке и о карточке в окне справки
image::linkInfo.png[Отображение информации о ссылке и о карточке в окне справки]

==== Заголовок

Текст, который отображается над ссылками. Заголовок выделяется жирным шрифтом. Рядом с заголовком отображается число ссылок.

`*Локализуемый*`

==== Колонки

Определяет набор колонок отображаемых по умолчанию в таблице ссылок. Если флаг в свойстве `*Разрешить настройку столбцов*` активен, пользователям будет предоставлена возможность изменить набор отображаемых столбцов.

.Настройки отображения колонок в таблице ссылок
image::linksConfigColumns.png[Настройки отображения колонок в таблице ссылок]

==== Метод для описания

.Определяет способ формирования информации о ссылке в таблице ссылок:
* *_Стандарт_*. В таблице будет отображаться дайджест карточки.
* *_Расширение_*. В таблице будет отображаться информация о карточке, возвращаемая серверным расширением {wc}а (в свойстве `*Наименование метода для описания*` должно быть указано название метода, предоставляемого расширением).
* *_Разметка_*. В таблице будет отображаться информация о карточке, формируемая разметкой с режимом выбора *_Описание_*. Если у карточки, на которую указывает ссылка, отсутствует разметка с режимом выбора *_Описание_*, в ссылке будет использоваться дайджест карточки.
+
TIP: Настройка применяется только к ссылкам на карточки.

==== Наименование метода для описания

Название метода расширения {wc}а, возвращающего описание ссылки. См. xref:programmer:serverExtensionsLinksDescriptionGenerator.adoc[Разработка расширения для формирования описаний ссылок].

Для карточек _Исходящий_, _Входящий_, _Заявка_, _ОРД_, _Рабочий_, _Служебная записка_, _Договор_, _Акт_ и _Доп. соглашение_ предоставляется стандартный метод для описания: `DocumentManagement_Default`.

==== Разрешить настройку столбцов

Разрешает или запрещает пользователям самостоятельно формировать список столбцов, отображаемых таблице ссылок.

==== Режим отображения

.Определяет способ работы с элементом управления:
* *_По умолчанию_*. Обычный способ работы с предоставлением полного набор команд управления ссылками, в соответствии с правами пользователя.
* *_Простой_*. Режим работы, предназначенный только для отображения ссылок: команды редактирования будут недоступны, а тип и значок ссылки скрыты.

=== Данные

include::partial$properties.adoc[tags=extendedDataSource]

include::partial$properties.adoc[tags=dataSource]

==== Поле данных

Поле карточки, содержащее ссылку на карточку _Список ссылок на карточки_.

==== Операция редактирования

Выбор операции для редактирования значения элемента управления. Если операция недоступна пользователю, то изменения списка ссылок или добавления комментария к ссылке будет недоступно. Если операция не выбрана, то возможность редактирования значения элемента управления не проверяется.

Если значение `*Операции редактирования*` наследуется от родительского Блока, название свойства меняется на `*Операция редактирования (наследовано)*`.

==== Хранить сильную ссылку

Определяется тип ссылки на карточку. Если флаг установлен, то используется сильная ссылка.

=== Поведение

include::partial$properties.adoc[tags=visibility]

==== Добавить гиперссылку

Настройка параметров добавления или просмотра ссылки на URL-адрес.

.Настройки добавления гиперссылки
image::linkListAddHyperLinkConfig.png[Настройки добавления гиперссылки]

Можно включить или отключить возможность добавления новой гиперссылки, при этом соответствующая кнопка будет показана или скрыта. Также можно указать операцию редактирования, при которой добавление гиперссылок будет разрешено. В поле _Протокол по умолчанию_ нужно указать протокол, который будет добавляться к адресу, введенному пользователем, если в адресе не указан конкретный протокол (`http`, `https`, `ftp` и т.п.). Добавление ссылок будет доступно всем, если операция редактирования не указана.

==== Добавить ссылку

Настройка параметров добавления или просмотра ссылки на существующую карточку.

.Настройки добавления ссылки
image::linkListAddLinkConfig.png[Настройки добавления ссылки]

* Флаг `*Доступно*`. Позволяет включить или отключить возможность добавления новой ссылки, при этом соответствующая кнопка будет показана или скрыта.
+
* Можно также указать _Операцию_ редактирования, при которой добавление ссылок будет разрешено.
+
Если операция редактирования не указана, добавление ссылок будет доступно всем.
* А также возможные типы ссылок.
+
[#cardTypesLimited]
* Настройка `*Типы карточек*` позволяет установить ограничение по типам карточек, на которые можно ссылаться.
+
Можно выбрать один или несколько типов карточек, на которые разрешено ссылаться.
+
Если типы карточек не выбраны, допускается добавление ссылок на карточки любых типов.
+
* _Поисковый запрос_. Открывает окно выбора поискового запроса. Выбранный поисковый запрос будет использоваться в режиме поиска карточек, при добавлении ссылок в режиме выбора *_Везде_*.
+
.Выбор поискового запроса
image::linksSelectQuery.png[Выбор поискового запроса]
+
NOTE: По умолчанию используется собственный поисковый запрос {wc}а: "Ссылки". Данный запрос позволяет искать карточки по дайджесту, автору, дате создания и изменения.
+
* _Список папок_. При нажатии открывается окно добавления папок (по идентификаторам). Из выбранных папок пользователь сможет выбирать карточки для добавления ссылок в режиме выбора *_В текущей папке_*.
+
.Список папок
image::linksSelectFolders.png[Список папок]
+
NOTE: Если список папок пуст, не отмечено ни одной добавленной папки или переключатель *Все папки / Только выбранные папки* в положении *Все папки*, пользователь сможет добавлять ссылки на карточки из любых доступных папок.

==== Добавить файл

Настройка параметров добавления или просмотра ссылки на файл.

.Настройки добавления файла
image::linkListAddFileConfig.png[Настройки добавления файла]

Диалоговое окно настройки добавления файла содержит:

* Флаг `*Доступно*`. Включает или выключает возможность добавления файла с помощью элемента управления "Ссылки".
* Поле _Операция_. Операция редактирования, которая должна быть доступна пользователю для разрешения добавления файла.
* Поле _Типы ссылок_. Тип ссылки, с которой будут добавляться файлы.
* Поле _Вид файла_. Вид карточки, которая будет создаваться для добавляемого файла.
+
Файл (или несколько) можно добавить с помощью кнопки image:buttons/attachFile.png[Скрепка] или "перетаскиванием" из файловой системы. При добавлении файлов, для каждого файла будет создана карточка вида _Вид файла_.
+
Пользователь может открыть файл, щелкнув по названию файла в списке ссылок или карточку файла из меню image:buttons/kebab.png[Три вертикальные точки]. Пользователь также может удалить ссылку на файл или сам файл.
+
Файл может быть удален, если на него ссылается только данная карточка.
* Если карточка файла содержит только один файл, то будет удалена его карточка и ссылка на неё,
* Если карточка файла содержит несколько файлов, из карточки файла будет удален только выбранный файл.

include::partial$properties.adoc[tags=addCss]

==== Загружать синхронно (шт)

Определяет максимальное количество элементов списка, при котором должна использоваться синхронная загрузка данных. Если количество элементов больше указанного, то все данные будут загружаться асинхронно.

==== Изменение

Выбор операции редактирования, при которой возможно изменение списка ссылок.

include::partial$properties.adoc[tags=editOperationForVisibility]

include::partial$properties.adoc[tags=disabled]

==== Отображать раскрытым

Определяет начальное состояние блока элемента управления. Когда флаг установлен, список ссылок отображается. Когда флаг не установлен -- список ссылок скрыт, отображается только заголовок и количество ссылок.

`*Адаптивный*`

include::partial$properties.adoc[tags=byTab]

==== Показывать файлы для ссылок

Настройка типов ссылок, для которых должен действовать особый режим отображения. При особом режиме редактирования в ЭУ отображается не карточка, на которую ссылка, а её основные и дополнительные файлы.

Пользователь может открыть файл, щелкнув по названию файла в списке ссылок или карточку файла из меню image:buttons/kebab.png[Три вертикальные точки]. Пользователь также может удалить ссылку на карточку или файл из карточки, на которую указывает ссылка.

Если настройка `*Показывать файлы для ссылок*` не задана для карточки, то возможность скачать файл из такой карточки будет недоступна.

==== Создать ссылку

Настройка параметров создания карточки с добавлением ссылки.

.Настройки создания карточки с добавлением ссылки
image::linkListAttachLinkConfig.png[Настройки создания карточки с добавлением ссылки]

Можно включить или отключить возможность создания ссылки с созданием карточки, при этом соответствующая кнопка будет показана или скрыта.

Также можно указать операцию редактирования, при которой создание ссылок будет разрешено, а также доступные для выбора типы ссылок. Если операция редактирования не указана, то добавление ссылок будет доступно всем.

Настройка `Виды карточек` позволяет указать виды карточек, которые можно создавать по ссылке:

* Можно выбрать один или несколько видов карточек, на которые разрешено ссылаться.
* Если вид карточек содержит подвиды, то при установленном в данной настройке флаге `*С дочерними видами*`, они также будут доступны для создания карточек по ссылке.
+
Если вид или виды карточек не выбраны, то добавление ссылки с созданием карточки будет невозможно.
+
Функция создания карточки с добавлением ссылки недоступна в разметке создания карточки.

include::partial$properties.adoc[tags=stdCss]

==== Удаление

Выбор операции редактирования, при которой возможно удаление ссылки.

=== События

==== Перед добавлением ссылки на новую карточку

Вызывается перед добавлением ссылки на новую карточку.

==== Перед добавлением ссылки на существующую карточку

Вызывается перед добавлением ссылки на существующую карточку.

==== Перед загрузкой ссылки на файл

Вызывается перед загрузкой ссылки на файл.

==== Перед закрытием тултипа с информацией о карточке

Вызывается перед закрытием окна (открытого кнопкой image:buttons/bt_showinfo.png[Информация]) с информацией о карточке.

==== Перед открытием карточки

Вызывается перед открытием карточки из списка ссылок.

==== Перед открытием предпросмотра карточки

Вызывается перед открытием предварительного просмотра карточки.

==== Перед открытием тултипа с информацией о карточке

Вызывается перед открытием (кнопкой image:buttons/bt_showinfo.png[Информация]) окна с информацией о карточке, на которую указывает ссылка.

include::partial$properties.adoc[tags=beforeExpand]

==== Перед редактированием комментария к ссылке

Вызывается перед редактированием комментария к ссылке в окне информации о карточке.

include::partial$properties.adoc[tags=beforeCollapse]

==== Перед удалением ссылки

Вызывается перед удалением ссылки.

==== Перед удалением файла

Вызывается перед удалением ссылки на файл.

==== После добавления ссылки на существующую карточку

Вызывается после добавления ссылки на существующую карточку.

==== После загрузки ссылки на файл

Вызывается после добавления ссылки на файл.

==== После изменения выделения

Вызывается после изменения выделения.

==== После переключения режима групповых операций

Вызывается после переключения режима групповых операций.

==== После разворачивания

Вызывается после разворачивания ЭУ кнопкой image:buttons/expand.png[Развернуть].

==== После редактирования комментария к ссылке

Вызывается после сохранения комментария (в окне информации о карточке) к ссылке.

==== После сворачивания

Вызывается после сворачиванием ЭУ кнопкой image:buttons/collapse.png[Свернуть].

==== После удаления ссылки

Вызывается после удаления ссылки.

==== После удаления файла

Вызывается после удаления файла.

include::partial$properties.adoc[tags=mouseOver]

include::partial$properties.adoc[tags=mouseAway]

include::partial$properties.adoc[tags=onClick]
