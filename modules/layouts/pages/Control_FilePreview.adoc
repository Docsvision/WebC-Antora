
== Предпросмотр файла

Элемент управления [.ph .uicontrol]*Предпросмотр файла* предназначен для отображения содержимого файла, выбранного в элементе xref:Control_filelist.adoc[Список файлов], xref:Control_taskCardFilePanel.adoc[Файловая панель], xref:Control_approvalFilePanel.adoc[Файловая панель согласования].

image::controls_filepreview_sample.png[[.fig--title-label]##Figure 1. ##Пример элемента управления «Предпросмотр файла» в разметке карточки]

Данный элемент управления позволяет:

* отображать содержимое файла непосредственно в разметке просмотра и редактирования карточки;
* отображать содержимое файла при загрузке карточки без необходимости выбора файла;
* переключаться между отображаемыми файлами;
* работать с несколькими элементами «Список файлов»: если в разметке несколько данных элементов, ЭУ «Предпросмотр файла» будет показывать содержимое активного элемента «Список файлов».

*Важные особенности использования элемента «Предпросмотр файла»:*

* В разметку можно добавить только один элемент «Предпросмотр файла».
* Элемент управления «Предпросмотр файла» должен быть добавлен в отдельный элемент xref:Control_block.adoc[Блок], в котором не должно быть других элементов кроме элемента «Предпросмотр файла».
* Родительский блок элемента «Предпросмотр файла» должен размещаться в блоке, содержащем только два дочерних элемента (см. рисунок ниже): блок с элементом «Предпросмотр файла» и блок с остальными элементами разметки.
+
image::filePreviewRecommendation.png[[.fig--title-label]##Figure 2. ##Пример структуры разметки, соответствующей требованиям]

Типы файлов, для которых поддерживается предварительный просмотр:

* «pdf»;
* офисные: «.docx», «.odt», «.doc», «.rtf», «.dot», «.dotx», «.xlt», «.xls», «.xltx», «.xlsx», «.ods»;
* изображения: «.jpg», «.jpeg», «.gif», «.png», «.bmp», «.tiff», «.tif», «.emf», «.wmf»;
* прочие: «.htm», «.adoc», «.js», «.xslt», «.xsl», «.xml», «.asmx», «.ascx», «.aspx», «.cpp», «.h», «.css», «.idl», «.ini», «.java», «.rc», «.rc2», «.shtm», «.shtml», «.txt», «.log», «.cs», «.sql», «.csv».

[NOTE]
====
[.note__title]#Note:# Особенности реализации: файлы с поддержкой предпросмотра транслируются в формат PDF на сервере {wc}, и отображаются на клиенте с использованием компонента https://mozilla.github.io/pdf.js/getting_started/[PDF.JS], который предоставляет пользователям следующие функции:

* переход между страницами,
* выбор масштаба,
* поиск по содержимому (только для текстовых документов),
* печать и др.

См. информацию по компоненту PDF.JS в сети Интернет.
====

Элемент «Предпросмотр файла» может быть добавлен в разметки создания, просмотра и редактирования карточек Документ, а также просмотра и редактирования карточек Задание и Группа заданий. *Работа элемента управления в разметке создания карточек Задание и Группа заданий НЕ поддерживается.*

== Свойства

Общие::
Название ЭУ:::
Название типа элемента управления.
Название:::
Уникальное название элемента управления.
Поведение::
Видимость:::
Настройка видимости. Элемент управления отображается в карточке, когда флаг установлен и не отображается вместе с содержимым, когда флаг снят.
+
`*Адаптивный*`
Высота (в пикселях):::
Устанавливает высоту элемента «Препросмотр файла» в пикселях.
Дополнительные css классы:::
Названия дополнительных классов CSS для изменения стиля элемента управления. Перечисляются через пробел.
Комментарии:::
Включает/выключает возможность комментирования файла.
Переходить по TAB:::
Флаг определяет последовательность перехода по ЭУ карточки при нажатии кнопки kbd:[TAB]. Если флаг установлен, переход по kbd:[TAB] разрешён.
Раскрывать файл:::
Включает/выключает режим отображения содержимого файла при загрузке разметки. При выключенном параметре содержимое файла отображается только после его выбора.
+
Если элемент «Список файлов» содержит несколько файлов, при включенном параметре «Раскрывать файл» будет отображаться первый файл по списку.
Стандартный css класс:::
Название CSS класса, в котором определен стандартный стиль элемента управления.
Ширина по умолчанию (в процентах):::
Ширина элемента в процентах относительно родительского элемента.
События::
Перед открытием/сокрытием блока комментариев:::
Вызывается перед открытием и закрытием блока комментариев.
Перед открытием/сокрытием окна:::
Вызывается перед закрытием окна предпросмотра.
Перед скачиванием файла:::
Вызывается при нажатии кнопки загрузки файла на компьютер.
Перед сменой файла:::
Вызывается перед сменой отображаемого файла.
После открытия/сокрытия блока комментариев:::
Вызывается после открытия и закрытия блока комментариев.
После открытия/сокрытия окна:::
Вызывается после закрытия окна предпросмотра.
После скачивания файла:::
Вызывается после нажатия кнопки загрузки файла на компьютер.
После смены файла:::
Вызывается после смены отображаемого файла.
При наведении курсора:::
Вызывается при входе курсора мыши в область элемента управления.
При отведении курсора:::
Вызывается, когда курсор мыши покидает область элемента управления.
При щелчке:::
Вызывается при щелчке мыши по любой области элемента управления.
