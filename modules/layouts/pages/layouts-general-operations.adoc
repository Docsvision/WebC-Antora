= Операции с разметками

== Общие операции с разметками

[#layoutsLimitations]
=== Ограничения при работе с разметками

При работе со списком разметок обратите внимание на следующие особенности:

* Разметка может быть двух типов: _для редактирования_ или _создания_ и для _просмотра_.
+
Для большинства видов карточек необходимо разрабатывать разметки обоих типов. Для общих локаций достаточно разработать только разметки просмотра.
+
* Разметка может входить только в одно Решение или в _Мои настройки_.
* К вида карточек могут быть собственные разметки или унаследованные от родителя в зависимости от настроек в _Справочнике видов карточек_.
+
WARNING: Если разметки наследуются, но у родительского вида не настроены собственные разметки, для открытия карточек будут использованы разметки типа карточек.
+
* Карточки, у которых нет собственных или унаследованных разметок, не могут быть открыты.

[#layoutsElements]
=== Элементы редактора разметок

{kvr} предоставляется с набором стандартных элементов управления, которые могут быть использованы для разработки разметок карточек и общих разметок. Данные стандартные элементы управления составляют _Библиотеку_ стандартных элементов управления.

Все элементы управления `_Библиотеки_` стандартных элементов управления делятся на несколько групп, в зависимости от функционального назначения:

* Главная страница.
* Главное меню.
* Групповые операции.
* Компоненты папки.
* Параметры поискового запроса.
* Профиль пользователя.
* Системные.
* Согласование.
* Специальные.
* Справочники.
* Стандартные.
* Таблицы.
* Фильтр папки.
* Элементы разметки.

Данные группы можно, условно разделить, на:

. Элементы разметки (далее -- *ЭР*) -- элементы управления для формирования блочной структуры разметки. Данные элементы управления следует рассматривать как контейнеры, в которые могут встраиваться другие элементы управления.
. Элементы управления (далее -- *ЭУ*) -- основные элементы управления, которые, как правило, можно связать с данными или использовать для вызова определённой функции (например, изменить состояние карточки).

Элементы управления обладают набором определённых настраиваемых свойств (базовых и собственных) и событий, на которые можно подписаться для их обработки в скрипте карточки.

В зависимости от локации и типа разметки, пользователю может быть доступен ограниченный набор элементов управления, а также их настроек.

NOTE: Полное описание стандартных элементов управления приведено в разделе xref:ctrl-library-standard.adoc[Описание стандартных элементов управления].

[#layoutsRootBlock]
=== Корневой блок разметки

Корневой блок разметки -- частный случай элемента управления `_Блок_`, в который встраиваются все остальные элементы разметки. `_Корневой блок_` может называться `_root_`, `_documentRoot_` и т.п.

- [*] В разметке может быть только один корневой блок.
- [*] Корневой блок является предком других элементов разметки.
- [*] Корневой блок не отображается в области _Компоновка_.
- [*] Корневой блок не содержит настроек ЭУ `_Блок_`, связанных с оформлением.
- [*] Корневой блок предоставляет возможность подписаться на xref:layouts-event-handler.adoc[события карточки] (утверждение справедливо для разметок карточек).
- [*] Корневой блок не может быть удалён или перемещен.

[#layoutsCreate]
=== Создать новую разметку

. xref:locations-select.adoc[Выберите локацию], для которой создаётся разметка, и xref:solution-change-current.adoc[Решение], в которое она будет включена.
. В рабочей области откройте вкладку _Разметки_.
. Нажмите кнопку *Создать* на ленте команд.
+
Будет открыто диалоговое окно создания разметки.
+
.Диалоговое окно создания разметки
image::create-layout-window.png[Диалоговое окно создания разметки]
+
NOTE: Возможность создания разметки карточки будет заблокирована, если выбрана локация вида, разметки которого наследуются (название локации серого цвета).
+
. Введите название создаваемой разметки, выберите её тип и нажмите кнопку *ОК*.
+
****
NOTE: Название разметки должно быть уникальным для данного вида. Если разметка с таким названием существует, будет выдано предупреждение: _Разметка с таким именем уже существует_; кнопка *ОК* при этом блокируется.

Тип разметки определяет режим работы с данными, в котором данная разметка будет использоваться. После создания разметки её тип изменить нельзя.

Для создания и изменения карточек используются разметки с типом _Для редактирования_.
****

Новая разметка будет добавлена в список разметок на странице _Разметки_. В столбце _Решение_ будет указано Решение, выбранное в списке `*Текущее решение*`, флаг `*Использование*` будет снят.

После создания разметку необходимо xref:layouts-about-setings.adoc[настроить]. Также необходимо настроить xref:conditions-about.adoc[условия] для выбора разметки.

[#layoutsCopy]
=== Копировать разметку

. Выберите копируемую разметку на вкладке xref:interface-layouts-tab.adoc[Разметки].
. Нажмите кнопку *Копировать* на ленте команд.
. В xref:interface-locations-tree.adoc[дереве локаций] выберите локацию, для которой копируется разметка.
. На вкладке _Разметки_ нажмите кнопку *Вставить* на ленте команд.
+
Разметка будет добавлена в выбранную локацию. Если есть разметка с аналогичным названием, к названию копии будет добавлен постфикс __Копия_.
+
****
При копировании может быть потеряна часть настроек элементов управления разметки, если они не поддерживаются локацией. Например, при копировании разметки одного типа карточек в другой, могут быть потеряны настройки связи с данными карточки, которых нет в целевом типе.
****

[#layoutsRename]
=== Переименовать разметку

. Выберите переименовываемую разметку на вкладке xref:interface-layouts-tab.adoc[Разметки].
. Нажмите на кнопку *Переименовать* на ленте команд.
. Введите новое название и нажмите кнопку *ОК*.
+
NOTE: Название разметки должно быть уникальным для данного вида. Если разметка с таким названием существует, будет выдано предупреждение: `Разметка с таким именем уже существует`. Кнопка *ОК* при этом блокируется.
