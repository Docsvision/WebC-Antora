= Управление согласованием

Элемент управления *Управление согласованием* предназначен для отправки документа на согласование и управления ходом активного согласования.

Элемент управления добавляет в карточку документа кнопку *На согласование* / *Управление* (название может быть настроено), при нажатии которой открывается боковая панель отправки или управления согласованием. На панели отображаются маршруты, которые были настроены с использованием средств модуля _Конструктор согласований_.

.Содержимое панели определяется текущим состоянием согласования:
* При создании согласования панель отображает настройки маршрута, а также кнопки отправки и отмены отправки согласования:
+
.Панель согласования при создании согласования
image::controls_agreementmanagement_send.png[Панель согласования при создании согласования]
* При управлении согласованием, когда есть активное согласование, панель отображает настройки этапа согласования, а также кнопки управления согласованием:
+
.Панель согласования при наличии активного согласования
image::controls_agreementmanagement_management.png[Панель согласования при наличии активного согласования]

Фактический набор команд и настроек панели согласования, которые будут доступны пользователю, зависит от следующих факторов:

.Факторы, влияющие на набор команд:
* Текущее состояние согласования.
* Доступность операции пользователю согласно автомату состояний и ролевой модели.
* Настройки маршрута согласования.
* Настройки элемента управления.
* Настройки этапа согласования:
** Чтобы иметь возможность исключить этап из маршрута, необходимо установить флаг `*Разрешить исключение этапа из маршрута*` в настройках этапа.
** Чтобы иметь возможность изменить длительность этапа и список согласующих, необходимо установить флаг `*Разрешить изменение параметров этапа*` в настройках этапа.
** Чтобы иметь возможность изменить тип маршрута, необходимо установить флаги `*Разрешить изменение параметров этапа*` и `*Разрешить редактирование типа маршрутизации*` в настройках этапа.

TIP: Данный ЭУ может быть добавлен только в разметку, предназначенную для просмотра карточек типа Документ.

== Свойства

Общие::
Название ЭУ:::
Название типа элемента управления.
Название:::
Уникальное название элемента управления.
Внешний вид::
Названия кнопок:::
Настройка названий кнопок управления согласованием.
+
Локализованные названия кнопок настраиваются в форме, открываемой при нажатии кнопки image:buttons/bt_dots.png[Три точки]:
+
.Форма настройки названий кнопок ЭУ "Управление согласованием"
image::ct_agreementmanagement_setnames.png[Форма настройки названий кнопок ЭУ "Управление согласованием"]
Поведение::
Видимость:::
Настройка видимости. Элемент управления отображается в карточке, когда флаг установлен и не отображается вместе с содержимым, когда флаг снят.
+
`*Адаптивный*`
Дополнительные css классы:::
Названия дополнительных классов CSS для изменения стиля элемента управления. Перечисляются через пробел.
Запрос подтверждения при старте:::
Настройка подтверждения отправки на согласование:
* Когда флаг установлен, при отправке на согласование отображается запрос на подтверждение отправки.
* Когда флаг не установлен, согласование запускается без дополнительного подтверждения.
Использовать последних:::
Если флаг установлен, при добавлении участников согласования отображаются последние выбранные исполнители.
Операция для прекращения этапа:::
Выбор операции, которая должна быть доступна пользователю для прекращения этапа согласования.
Операция для старта согласования:::
Выбор операции, которая должна быть доступна пользователю для запуска согласования.
Операция для управления согласованием:::
Выбор операции, которая должна быть доступна пользователю для управления согласованием.
Операция редактирования для видимости:::
Определяет операцию, которая должна быть доступна пользователю для показа данного элемента управления. Действие настройки зависит от значения настройки _Видимость_:
+
* Когда флаг `*Видимость*` установлен и выбрана _операция редактирования для видимости_, видимость элемента определяется исходя из доступности пользователю выбранной операции редактирования.
* Когда флаг `*Видимость*` установлен, и _операция редактирования для видимости_ НЕ выбрана, ЭУ отображается всегда.
* Когда флаг `*Видимость*` НЕ установлен, ЭУ всегда скрыт.
Отключен:::
Когда флаг установлен, отключается возможность изменить значения элемента управления. Работает совместно со свойством `*Операция редактирования*`: если одно из свойств запрещает редактирования, редактирование будет запрещено.
+
`*Адаптивный*`
Переходить по TAB:::
Флаг определяет последовательность перехода по ЭУ карточки при нажатии кнопки kbd:[TAB]. Если флаг установлен, переход по kbd:[TAB] разрешён.
Режим:::
Определяет режим отображения кнопок старта и управления согласованием. Возможные варианты:
+
* *_Старт и Управление_* - когда согласование запущено, отображаются кнопки управления согласованием. Когда согласование не запущено, отображается кнопка запуска согласования.
* *_Только Старт_* - отображается только кнопка запуска согласования, если оно не запущено.
* *_Только Управление_* - отображаются только кнопки управления согласованием, если оно запущено.
Стандартный css класс:::
Название CSS класса, в котором определен стандартный стиль элемента управления.
Управление согласованием:::
Открывает форму настройки списка отображаемых в ЭУ кнопок управления согласованием: *Остановить*, *Отменить* и *Завершить*.
+
.Форма настройки доступности кнопок управления согласованием ЭУ "Управление согласованием"
image::ct_agreementmanagement_enablebuttons.png[Форма настройки доступности кнопок управления согласованием ЭУ "Управление согласованием"]
+
Кнопки управления, с которых снят флаг, будут скрыты с панели управления согласованием.
+
Кнопка *Управление согласованием* недоступна, если свойство `*Режим*` в значении *_только Старт_*.
Формат отображения Согласующего:::
Определяет формат отображения имен согласующих на панели согласования:
+
* ФИО
* ФИО+Должность
* Строка отображения - используется формат отображения, настроенный в _Справочнике сотрудников_
События::
Перед добавлением участника согласования:::
Вызывается перед добавление участника согласования.
Перед изменением пути согласования:::
Вызывается перед изменением пути согласования.
Перед остановкой согласования:::
Вызывается перед остановкой согласования.
Перед остановкой Этапа:::
Вызывается перед остановкой этапа согласования.
Перед открытием панели согласования:::
Вызывается перед открытием панели согласования.
Перед отменой согласования:::
Вызывается перед отменой согласования.
Перед отменой старта согласования (закрытием панели):::
Вызывается перед отменой старта согласования, перед закрытием панели согласования.
Перед принудительным завершением согласования:::
Вызывается перед принудительным завершением согласования.
Перед продолжением согласования после паузы:::
Вызывается перед продолжением согласования после паузы.
Перед стартом согласования:::
Вызывается перед стартом согласования.
Перед удалением участника согласования:::
Вызывается перед удалением участника согласования.
После добавления участника согласования:::
Вызывается после добавления участника согласования.
После изменения пути согласования:::
Вызывается после изменения пути согласования.
После остановки Этапа:::
Вызывается после остановки этапа согласования.
После открытия панели согласования:::
Вызывается после открытия панели согласования.
После отмены старта согласования (закрытия панели):::
Вызывается после отмены старта согласования, после закрытия панели согласования.
После удаления участника согласования:::
Вызывается после удаления участника согласования.
При наведении курсора:::
Вызывается при входе курсора мыши в область элемента управления.
При отведении курсора:::
Вызывается, когда курсор мыши покидает область элемента управления.
При щелчке:::
Вызывается при щелчке мыши по любой области элемента управления.
