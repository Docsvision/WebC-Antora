= Произвольное подписание документов

Пользователь может подписать электронной подписьюfootnote:[Определяется настройками вида документа.] (ЭП): основные и дополнительные файлы, атрибуты документа.

Подписание выполняется с целью защиты данных карточки от изменений, после изменения данных ЭП станет недействительной.

Документ может быть подписан простой, усиленной или квалифицированной ЭП. Возможность подписания тем или иным видом ЭП регулируется настройками системы {dv}, а также наличием необходимых программных средств на компьютере пользователя.

.Ограничения подписания
****
Возможность добавления новых подписей блокируется, если лицензия на компоненты КриптоПро CSP истекла. Проверка старых подписей с действующим сертификатом ЭП будет выполняться даже при истёкшем срок действия компонентов КриптоПро.

Со стандартными настройками система {dv} не поддерживает подписание файлов размером больше 35 МБ усиленной или квалифицированной ЭП.

Работа с ЭЦП на iOS и Android через интерфейс {wc}а не поддерживается без специального мобильного приложения.
****

.Чтобы подписать документ:
. Откройте карточку документа в xref:cardsOpenModes.adoc#openInReadMode[режиме чтения].
. В разделе _Файлы_ нажмите image:buttons/butt_sing_file.png[Прозрачная печать] > Подписать.
+
.Подписание документов
image::dcard_file_signature.png[Подписание документов]
+
На экране появится окно _Электронная подпись_.
+
.Параметры электронно-цифровой подписи
image::dcard_file_signature_label_select.png[Параметры электронно-цифровой подписи]
+
. Выберите метку для подписи.
+
****
Метки конкретизируют решение сотрудника, подписавшего карточку документа.

Если метки отсутствуют (в _Справочнике меток подписей_), поле выбора метки не отображается.
****
+
. Выберите вариант подписания:
* *_Простая подпись_* -- документ будет подписан учетной записью сотрудника.
+
TIP: Функция может быть недоступна, если простая подпись запрещена настройками карточки.
* *_Выберите сертификат_* -- документ будет подписан усиленной подписью.
+
TIP: Чтобы иметь возможность подписать документ усиленной подписью, необходимо установить компоненты xref:prepareInstallCryptoPro.adoc[КриптоПро].
+
.Варианты подписания
****
Выбор варианта подписания зависит от настроек _Справочника сотрудников_ и наличия действительных сертификатов в персональном хранилище пользователя:

.Компоненты для работы с усиленной ЭП, не установлены:
- В окне будет отображаться подсказка: `Не установлен компонент для использования усиленной подписи` и в списке будет доступен только вариант *_Простая подпись_*.

.Компоненты для работы с усиленной ЭП, установлены:
* Если в персональном хранилище есть только один действительный сертификат, в списке вариантов подписания будут присутствовать этот сертификат и *_Простая подпись_*.
* Если сертификат не совпадает с указанным в справочнике сотрудников, в дополнение к сертификату и *_Простой подписи_* будет отображаться предупреждающее сообщение: `Сертификат в персональном хранилище не совпадает с указанным в Справочнике сотрудников`.
* Если в персональном хранилище у пользователя есть несколько сертификатов, в списке будут присутствовать варианты:
** *_Простая подпись_*,
** Название сертификата из _Справочника сотрудников_, если он указан и найден в хранилище
** *_Выберите сертификат_*. Открывает окно выбора сертификата из списка действительных, установленных в персональном хранилище.
+
.Окно выбора сертификата для подписания
image::certList.png[Окно выбора сертификата для подписания]
+
* Если в хранилище сертификатов нет, в окне будет отображено соответствующее сообщение.
+
TIP: Квалифицированные сертификаты выделяются жирным.
****
+
. Если для наложения усиленной подписи требуется выбрать сертификат, кликните по строке с информацией о нём.
. Нажмите на кнопку *Подписать*.
+
****
После подписания появится сообщение `Электронная подпись сформирована успешно`. Цвет значка image:buttons/butt_sing_file.png[Прозрачная печать] сменится на чёрный.

Ознакомиться с информацией о подписях документа можно в xref:documentsSigntaureLog.adoc[журнале наложенных подписей].
****
