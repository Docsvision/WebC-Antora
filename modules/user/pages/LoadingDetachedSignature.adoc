
== Загрузка отсоединённой электронной подписи файла

{wc} поддерживает возможность загрузки отсоединённой электронной подписи в карточку Документа для подписания основного файла.

https://ca.kontur.ru/articles/ecp-terminy[Отсоединённая ЭП] -- файл формата P7S, SIGN, SGN или SIG, содержащий электронную подпись подписанного документа (файла). Отсоединённая ЭП может быть загружена с использованием кодировки DER или BASE-64.

[NOTE]
====
[.note__title]#Note:# {wc} поддерживает загрузку отсоединённых подписей только основных файлов.
====

Для загрузки отсоединённой подписи:

. Откройте карточку Документ, в которую загружается отсоединённая подпись.
. Перейдите к разделу *Файлы*.
. Загрузите электронную подпись:
* Если карточка Документ содержит файл, для которого загружается отсоединённая подпись:
[loweralpha]
.. В строке *основного* файла, для которого загружается подпись, нажмите [.ph .menucascade]#*image:buttons/verticalDots.png[Три вертикальные точки]* > *Загрузить ЭП*#.
.. Выберите файл отсоединённой подписи (P7S, SIGN, SGN или SIG).
.. Нажмите *Открыть* для загрузки выбранного файла.
* Если файл с отсоединённой подписью загружается вместе с подписью:
[loweralpha]
.. Нажмите [.ph .menucascade]#*image:buttons/attachFile.png[Папка]* > *+основной*#.
.. Выберите подписанный файл и файл, содержащий отсоединённую подпись (P7S, SIGN, SGN или SIG).
.. Нажмите *Открыть* для загрузки выбранных файлов.
+
В атрибуте "Имя файла" отсоединённой электронной подписи должно содержаться название файла, которому принадлежит данная подпись, иначе загрузка будет невозможна.
+
[NOTE]
====
[.note__title]#Note:# Возможность загрузки электронной подписи будет недоступна, если запрещена операция редактирования для добавления подписи.
====

* Если карточка Документ содержит файл с отсоединённой подписью или он выбран для загрузки вместе с файлом, содержащим отсоединённую подпись, подпись будет прикреплена к файлу (проверьте с помощью xref:task_dcard_file_signature_check.adoc[журнала электронно-цифровых подписей]). Подпись прикрепляется к текущей версии основного файла.
* Если файл, к которому должна быть присоединена подпись, отсутствует в Документе, будет выдано сообщение о невозможности загрузки подписи -- другие файлы, выбранные при загрузки, будут загружены (при наличии прав).
* Если присоединяемая подпись недействительна, будет выдано сообщение об ошибке -- подпись загружена не будет.
* Если оставшийся срок действия сертификата подписи составляет менее 5 дней, будет выдано предупреждение: "Срок действия сертификата закончится <Дата>". Пользователь может подтвердить или отменить загрузку подписи.
* Если выбран файл с *присоединённой* электронной подписью (файл-контейнер, содержащий и подписанный файл и электронную подпись), будет выдано предупреждение: "Необходимо использовать отсоединенную подпись".
