= Отправить документ на согласование и изменить маршрут согласования

== Отправить документ на согласование

. Создайте или откройте автором карточку согласуемого документа. Карточка должна быть в состоянии _Подготовка_.
+
****
* К документу должен быть приложен минимум один основной файл, который будет передан на согласование.
* В карточке должны быть указаны согласующие и, если нужно подписание, подписывающие. Список участников согласования можно изменить при отправке документа, если данная возможность была разрешена при настройке {wc}а.
****
+
. Откройте панель подтверждения маршрута согласования нажатием кнопки *На согласование* на xref:cardsTerms.adoc#cardsOperations[панели операций].
+
.Панель подтверждения маршрута согласования в карточке "Документ"
image::approvalRouteParams.png[Панель подтверждения маршрута согласования в карточке "Документ"]
+
****
Если по документу уже проводилось согласование, будет предложено предварительно очистить лист согласования от записей предыдущего согласования.

Если не очистить лист согласования, записи по новому согласованию будут добавляться к записям по предыдущему.

Вне зависимости от выбора результаты старого согласования не повлияют на результаты нового.
****
+
. В списке маршрутов выберите маршрут, по которому пойдет согласование.
+
.Маршрут согласования
image::approvalRoute.png[Маршрут согласования]
+
****
Маршруты для вида документов формируются при настройке {dv}.
****
+
. Если требуется, <<modifyRoute,измените>> стандартные настройки маршрута согласования.
. Нажмите кнопку *Отправить*, чтобы запустить согласование.
+
. В появившемся окне нажмите кнопку *OK*, чтобы подтвердить отправку.
+
****
Будут сформированы задания для согласующих.

Карточка Документа перейдет в состояние _На согласовании_

Процесс отправки заданий может занять некоторое время.

CAUTION: На согласование поступают только _основные_ файлы, приложенные к карточке. _Дополнительные_ файлы не участвуют в согласовании, но будут также приложены к заданиям.
****

[#modifyRoute]
== Изменить маршрут согласования

Пользователь может изменить настройки маршрута согласования, если данная возможность была разрешена при настройке согласования.

=== Исключить этап из согласования

Чтобы исключить этап из согласования, установите переключатель напротив этапа в положение *Выключено* (левое).

.Маршрут с исключенным этапом "Подписание"
image::modifyApprovalWithDisableSign.png[Маршрут с исключенным этапом "Подписание"]

include::partial$excerpts.adoc[tags=functionIsNotAvailable]

.Этап согласования с заблокированным переключателем исключения этапа
image::modifyApprovalLocked.png[Этап согласования с заблокированным переключателем исключения этапа]

=== Изменить состав согласующих

Пользователь может добавить, удалить или изменить порядок, а также временно исключить согласующих.

.Чтобы изменить состав согласующих:
. Откройте настройки этапа, выбрав этап из списка.
+
.Настройка согласующих этапа "Согласование"
image::approvalRouteParams3.png[Настройка согласующих этапа "Согласование"]
+
. Измените состав согласующих как описано ниже:
+
--
.Чтобы добавить согласующего:
.. Нажмите на кнопку image:buttons/selectorBook.png[Книга].
.. Выберите согласующего из xref:appendix/ctrlStaffDirectoryItems.adoc[Справочника сотрудников].
+
TIP: Если выбрано подразделение, группа или роль, в согласование будут добавлены сотрудники, включенные в выбранный узел в _Справочнике сотрудников_.
--
+
--
.Чтобы удалить или исключить согласующего:
.. Наведите курсор мыши на строку согласующего, чтобы отобразить функции удаления или исключения согласующего.
.. Чтобы временно исключить согласующего только из данного цикла согласования, снимите флаг в строке согласующего.
.. Удалите согласующего нажатием кнопки image:buttons/basket.png[Корзина].
--
+
--
.Чтобы изменить порядок согласующих:
.. Переместите участника выше или ниже, удерживая при этом левую кнопку мыши.
--
+
.Особенности настройки списка согласующих:
****
Если в активном этапе не указаны согласующие, переключатель для исключения этапа будет выделен желтым. Укажите согласующих или исключите этап.

.Этап "Согласования" без согласующих
image::approvalPanelWithoutPerformers.png[Этап "Согласования" без согласующих]

Возможность изменить состав согласующих может быть заблокирована по двум причинам:

- Если в настройках этапа снят флаг `*Разрешить изменение параметров этапа*`. В этом случае блок с составом согласующих будет заштрихован:
+
.Этап согласования с заблокированным изменением настроек
image::modifyApprovalWithStateLocked.png[Этап согласования с заблокированным изменением настроек]

- Если состав согласующих определяется с помощью бизнес-процесса. В данном случае этап будет помечен значком `А` (автоматически):
+
.Этап согласования с автоматическим определением согласующих
image::modifyApprovalWithAutomatic.png[Этап согласования с автоматическим определением согласующих]
****

=== Изменить тип маршрутизации

. Откройте настройки этапа, выбрав его из списка.
+
.Настройка согласующих этапа Согласование
image::approvalRouteParams3.png[Настройка согласующих этапа Согласование]
. Выберите из списка новый тип маршрутизации заданий согласования:
* *_Последовательно_*. Участники согласования будут получать задания по очереди, следующий участник получит задание после выполнения задания предыдущим исполнителем.
* *_Параллельно_*. Все участники согласования получат задания одновременно.
* *_Альтернативно_*. Вместо отдельных заданий для каждого согласующего будет сформировано одно задание на всех выбранных согласующих. Исполнителем задания становится сотрудник, который первым возьмет задание в работу. У остальных согласующих задание будет удалено.
+
include::partial$excerpts.adoc[tags=functionIsNotAvailable]
+
.Этап согласования с заблокированной возможностью изменения типа маршрутизации
image::modifyApprovalWithDisableRouteType.png[Этап согласования с заблокированной возможностью изменения типа маршрутизации]
