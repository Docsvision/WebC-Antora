= Список файлов

Элемент управления `_Список файлов_` предназначен для работы с файлами карточек _Документ_.

.ЭУ "Список файлов" предоставляет следующие функции работы с файлами:
- <<addFiles,Добавлять файлы>>,
- <<fromScanner,Добавлять файлы со сканера>>,
- <<deleteFile,Удалять файлы>>,
- <<previewFile,Просматривать файлы>> (ограничено),
- <<editFile,Редактировать файлы>> (ограничено),
- <<newVersionOfFile,Загружать новые версии файлов>>,
- <<renameFile,Переименовывать файлы>>,
- <<signFile,Подписывать файлы>>,
- <<signatureValidation,Проверять подписи файлов>>,
- <<importSignatureFile,Импортировать и экспортировать электронные подписи>>,
- <<exportFileWithSignature,Экспортировать файлы с подписью>>.

.Список файлов
image::layouts:exportESignButton.png[Список файлов]

[#addFiles]
== Условия для добавления файлов

.Типы файлов, которые можно добавлять
****
`.docx`, `.pdf`, `.rtf`, `.dot`, `.doc`, `.dotm`, `.docm`, `.dotx`, `.ods`, `.odt`, `.csv`, `.xlt`, `.xls`, `.xltm`, `.xlsm`, `.xltx`, `.xlsx`, `.jpg`, `.jpeg`, `.gif`, `.png`, `.bmp`, `.tiff`, `.tif`, `.emf`, `.wmf`, `.xslt`, `.xsl`, `.xml`, `.htm`, `.html`, `.txt`, `.log`, `.cs`, `.asmx`, `.ascx`, `.aspx`, `.js`, `.cpp`, `.h`, `.css`, `.idl`, `.ini`, `.java`, `.rc`, `.rc2`, `.shtm`, `.shtml`, `.sql`, `.zip`, `.rar`, `.7z`, `.vsd`, `.vsdx`, `.msg`, `.one`, `.pptx`, `.ppt`, `.avi`, `.wav`, `.p7s`, `.sig`, `.sgn`, `.sign`.

Список может быть изменён администратором {wc}а.

TIP: Для возможности загрузки файлов `.ascx`, `.cs` и `.java` требуется xref:admin:installAfter.adoc#java[дополнительная настройка].
****

Суммарный объем файлов, добавляемых в карточку _Документ_ на этапе создания карточки, не должен превышать 128 Мб. Файл сверх этого размера можно добавить из xref:cards-open-modes.adoc#openInReadMode[режима чтения] карточки (см. <<fromFileSystem,далее>>). Администратор может установить собственные ограничение на максимальный размер прикладываемых файлов.

include::partial$excerpts.adoc[tags=letters]

[NOTE]
====
Добавление дополнительных файлов xref:layouts:ctrl/special/fileList.adoc#allowAdditional[может быть запрещено] при настройке {wc}а.

Сканирование файлов доступно только, если функция xref:layouts:ctrl/special/fileList.adoc#allowScan[разрешена] при настройке {wc}а.
====

[#fromFileSystem]
== Добавление файлов из файловой системы

Элемент управления предоставляет несколько способов добавления файлов с файловой системы:

. Щелкните по области _Прикрепить файлы_.
+
****
Будет предложено выбрать файлы.
****
+
. Нажмите кнопку image:buttons/attachFile.png[Папка] и щелкните по типу добавляемого файла: _основной_ или _дополнительный_.
. Выберите файлы для добавления.
+
****
Если добавление дополнительных файлов запрещено, вместо выбора типа файла будет сразу открыт диалог добавления.
****
+
. Перетяните файл(ы) из файловой системы в область _Прикрепить файлы_.
+
Элемент `_Список файлов_` трансформируется:
+
.Элемент "Список файлов" при разрешенном добавлении дополнительных файлов.
image::attachFileMainOrAdditional.png[Элемент "Список файлов" при разрешенном добавлении дополнительных файлов]
+
.Элемент "Список файлов" при запрещенном добавлении дополнительных файлов
image::attachOnlyMainFile.png[Элемент "Список файлов" при запрещенном добавлении дополнительных файлов]
+
.Перетащите файл(ы) в раздел _Основные файлы_ или, если разрешено, в _Дополнительные файлы_.

После добавления файла или файлов элемент `_Список файлов_` примет вид списка файлов:

.Элемент "Список файлов" с выбранными файлами
image::fileList_withdata_editmode.png[Элемент "Список файлов" с выбранными файлами]

Если возможность добавления дополнительных файлов отключена, элемент `_Список файлов_` не разделяется на области основных и дополнительных файлов; в заголовке элемента отображается количество приложенных основных файлов.

.Элемент `_Список файлов_` с выбранными файлами с запрещенным добавлением дополнительных файлов
image::attachOnlyMainFileView.png[Элемент "Список файлов" с выбранными файлами с запрещенным добавлением дополнительных файлов]

[#fromScanner]
== Добавление файлов со сканера

=== Условия для добавления файла со сканера

Элемент управления предоставляет возможность добавлять файлы со сканера, если:

. Функция xref:layouts:ctrl/special/fileList.adoc#allowScan[активирована] при настройке {wc}а.
. Пользователь работает на персональном компьютере с операционной системой Windows.
. Установлена и запущена программа xref:prepareInstallAdditionalComponents.adoc#dvWebTool[DVWebTool].
. На компьютере зарегистрирован совместимый сканер (любой WIA или TWAIN-сканер).

=== Добавить файл со сканера

.Чтобы добавить файл со сканера:
. Нажмите кнопку image:buttons/attachFileFromScan.png[Сканирование документа] и выберите тип добавляемого файла: _основной_ или _дополнительный_ (если разрешено).
+
****
Будет открыто окно сканирования.
****
+
.Окно сканирования
image::attachFileScanMode.png[Окно сканирования]
. Выберите используемый сканер в списке _Сканер_.
. Выберите разрешение сканера из списка доступных. Чем выше разрешение, тем лучше качество изображения, но больше размер файла.
. Выберите цветность получаемого изображения: *цветное*, *черно-белое*, *оттенки серого*.
+
Параметры сканирования сохраняются в браузере и устанавливаются автоматически при следующем открытии окна сканирования.
. Если требуется предварительно оценить сканируемый документ, нажмите кнопку *Предпросмотр*.
+
****
После завершения сканирования в области предварительного просмотра появится изображение.
****
+
. В зависимости от количества сканируемых страниц нажмите кнопку *Сканировать страницу* или *Сканировать несколько страниц* (сканер должен поддерживать функцию потокового сканирования).
+
****
Документ будет отсканирован. После этого можно:

* Повернуть изображение с помощью кнопок image:buttons/scanRotateLeft.png[Повернуть на 90 градусов влево] и image:buttons/scanRotateRight.png[Повернуть на 90 градусов вправо],
* Изменить масштаб и посмотреть другие страницы.
****
+
. Укажите название файла, с которым он будет добавлен в карточку.
. Выберите тип файла: `.pdf` или `.jpeg`. Если сканируется несколько страниц, будет использован формат `.pdf`.
. Нажмите кнопку *Сохранить*. Файл будет добавлен в карточку.

== Изменить тип файла

Чтобы изменить тип добавленного файла (_основной_ или _дополнительный_), перетащите его в область файлов другого типа: из _основных_ в _дополнительные_, или наоборот.

.Изменить тип файла
image::fileListChangeFileType.png[Изменение типа файла]

Если возможность добавления дополнительных файлов отключена, изменить тип файла описанным образом нельзя.

[#renameFile]
== Переименовать файл

.Чтобы переименовть файл:
. Нажмите image:buttons/verticalDots.png[Три вертикальные точки] *> Переименовать в строке файла*.
+
Переименование будет недоступно, если файл заблокирован или отсутствуют права на изменение имени файла (операция _Переименование файлов_).
+
. Введите новое имя файла в открывшемся окне.
+
.Переименование файла
image::fileList_changename.png[Переименование файла]
+
. Нажмите кнопку *OK*. Будет создана новая версия файла с указанным именем. Файлы в существующих версиях не переименовываются. Если имя файла не изменилось, новая версия не создаётся.

.Ограничения для имени файла
****
* Название файла не может содержать символы: `*`, `/`, `\`, `|`, `<`, `>`, `“`, `?`, `:`. При попытке сохранить файл с запрещенными символами будет выдана ошибка `Заданное имя не является допустимым именем файла`.

* В имени файла нельзя указать имя другого существующего файла карточки.

TIP: Функция _Переименовать_ не может быть использована для изменения расширения файла.
****

[#deleteFile]
== Удалить файл

.Чтобы удалить файл из карточки:
* Нажмите кнопку image:buttons/redCross.png[Крестик] в строке удаляемого файла при создании или редактировании карточки.
+
****
Удаляемый файл, а также его карточка должны быть разблокированы.
****
+
* В строке файла нажмите кнопку image:buttons/verticalDots.png[Три вертикальные точки] *> Удалить* при просмотре карточки.
+
****
Удаление нужно подтвердить.
****
+
WARNING: При удалении будут удалены все версии данного файла.

== Другие операции с файлами

*_Следующие операции доступны только, если карточка открыта xref:cards-open-modes.adoc#openInReadMode[в режиме чтения]._*

[#openFile]
=== Открыть файл

Чтобы открыть файл в связанной программе нажмите image:buttons/verticalDots.png[Три вертикальные точки] *> Открыть* в строке файла.

.Условия открытия файлов
****
В связанной программе можно открыть только файлы Microsoft Office, если только если установлена соответствующая программа из пакета: `.doc`, `.docx`, `.docm`, `.xls`, `.xlsx`, `.xlsm`, `.ppt`, `.pptx`, `.odt` и `.ods`.

Дополнительные файлы открываются в режиме чтения. Основные файлы, доступные для редактирования в режиме редактирования. Открытый для редактирования файл будет заблокирован от изменений со стороны других пользователей. При сохранении файла с изменениями будет создана его новая версия.

NOTE: До завершения редактирования файла не закрывайте карточку, из которой он был открыт.

include::partial$excerpts.adoc[tags=openOnlyInIE]
****

[#previewFile]
=== Предварительный просмотр файла

Нажмите на название файла, чтобы открыть его в режиме предварительного просмотра. Инструкция по работе с компонентом предпросмотра приведена в пункте xref:appendix/ctrlFilePreview.adoc[Предпросмотр файла].

=== Скачать файл

Чтобы сохранить файл карточки на компьютер, нажмите image:buttons/verticalDots.png[Три вертикальные точки] *> Скачать* в строке файла.

=== Блокировать/разблокировать основной файл

Основой файл может быть временно заблокирован для защиты от изменений со стороны других пользователей.

Чтобы блокировать или разблокировать файл, нажмите image:buttons/verticalDots.png[Три вертикальные точки] *> Заблокировать* или *Разблокировать* в строке файла. Заблокированный файлы выделяются розовой заливкой фона.

=== Просмотреть версии основного файла

Текущая версия файла отображается в основной области списка файлов. Номер текущей версии указывается справа от названия файла.

.Текущая версия файла
image::mainFileCurrentVersion.png[Текущая версия файла]

Чтобы просмотреть другие версии файла, нажмите на номер текущей версии. Для версии указываются номер, автор и дата создания (добавления файла).

.Список версий файла
image::mainFileVersions.png[Список версий файла]

[#newVersionOfFile]
=== Загрузить новую версию основного файла

Чтобы загрузить новую версию файла, нажмите image:buttons/verticalDots.png[Три вертикальные точки] *> Загрузить версию* в строке файла и выберите новую версию файла из файловой системы. Название и тип файла новой версии может отличаться от существующей -- все существующие версии остаются без изменений. После загрузки версии номер текущей версии увеличится.

.Новая версия файла
image::mainFileNewCurrentVersion.png[Новая версия файла]

=== Скачать версию основного файла

Чтобы сохранить определенную версию файла на компьютер, откройте список версий и нажмите кнопку image:buttons/load.png[Скачать] в строке скачиваемой версии.

[#editFile]
=== Изменить файл

.Способ изменения файла зависит от его типа:
* Чтобы изменить основной файл, нужно скачать его на компьютер, внести изменения в скачанный файл и загрузить его новую версию в карточку.
* Чтобы изменить основной файл формата Microsoft Office можно <<openFile,открыть>> его из меню, внести изменения и закрыть с сохранением.
* Чтобы изменить дополнительный файл, нужно скачать его на компьютер, внести изменения в скачанный файл, удалить данный файл из карточки и загрузить измененный файл в карточку.

[#signFile]
=== Подписать файл

Чтобы подписать файл, нажмите image:buttons/signatureFile.png[Прозрачная печать] *> Подписать* и выберите вид подписи и сертификат электронной подписи (для квалифицированной подписи). См. подробности в пункте xref:docs-signing.adoc[Произвольное подписание документов].

[#exportFileWithSignature]
=== Выгрузить файлы с электронными подписями

Чтобы экспортировать основные подписанные файлы вместе с электронными подписями, нажмите image:buttons/exportFilesWithSign.png[Файлы с прозрачной печатью]. См. подробности в пункте xref:docs-signing.adoc#exportSignedFiles[Экспортировать файлы с полписью].

[#importSignatureFile]
=== Загрузить отсоединённую электронную подпись

Чтобы загрузить отсоединённую электронную подпись основного файла нажмите image:buttons/verticalDots.png[Три вертикальные точки] *> Загрузить ЭП* в строке файла и выберите файл отсоединённой подписи. Поддерживаются форматы `.p7s`, `.sign`, `.sgn` или `.sig`, подробнее в пункте xref:docs-signing.adoc#loadDetachedSignature[Загрузка отсоединённой электронной подписи файла].

[#signatureValidation]
=== Проверить электронные подписи

В элементе управления отображается список наложенных подписей. При нажатии на image:buttons/signatureBlack.png[Заполненная печать] будет открыто окно со списком подписей и результатами их проверки. Подробнее см. xref:docs-signing.adoc#signatureValidation[].