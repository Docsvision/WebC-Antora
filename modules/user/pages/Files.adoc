
== Список файлов

Для работы с файлами карточек Документ предназначен компонент «Список файлов». Данный элемент позволяет добавлять, удалять и просматривать (ограничено) файлы, редактировать (ограничено) файлы и загружать новые версии файлов, переименовывать, подписывать и проверять подписи файлов, а также загружать электронные подписи и выгружать файлы с подписью.

image::filesInCreateMode.png[[.fig--title-label]##Figure 1. ##Список файлов]

Условия для добавления файлов:

* Типы файлов, которые можно добавлятьxref:#fntarg_1[^1^]: docx, pdf, rtf, dot, doc, dotm, docm, dotx, ods, odt, csv, xlt, xls, xltm, xlsm, xltx, xlsx, jpg, jpeg, gif, png, bmp, tiff, tif, emf, wmf, xslt, xsl, xml, htm, html, txt, log, cs, asmx, ascx, aspx, js, cpp, h, css, idl, ini, java, rc, rc2, shtm, shtml, sql, zip, rar, 7z, vsd, vsdx, msg, one, pptx, ppt, avi, wav. Список может быть изменён администратором {wc}а.

* Суммарный объем файлов, добавляемых в карточку _Документ_ на этапе создания карточки, не должен превышать 128 МБ. Файл большего размера можно добавить из режима просмотра карточки (см. далее). Администратор может установить собственные ограничение на максимальный размер прикладываемых файлов.
* Хранение букв "ё" и "й" в операционных системах MacOS и Windows различается, поэтому рекомендуется избегать использования этих букв в названиях файлов (если планируется работать с файлами в обеих системах).

[NOTE]
====
[.note__title]#Note:#

* _Возможность добавления дополнительных файлов может быть запрещена при настройке модуля._
* _Возможность сканирования файлов предоставляется, если разрешена при настройке модуля._
====

Операции:

* {blank}
+
*Добавление файлов с файловой системы.* Элемент управления предоставляет несколько способов добавления файлов с файловой системы:

** Щелкните по области «Прикрепить файлы». Будет предложено выбрать файлы. Выбранные файлы будут добавлены как «основные».
** Нажмите кнопку image:buttons/attachFile.png[Папка] и щелкните по типу добавляемого файла: «основной», «дополнительный». Выберите файлы для добавления. Если добавление дополнительных файлов запрещено, вместо выбора типа файла будет сразу открыт диалог добавления.
** Перетяните файл (или файлы) с файловой системы в область «Прикрепить файлы». Элемент «Список файлов» трансформируется:
*** вид при разрешенном добавлении дополнительных файлов:
+
image::attachFileInSelectTypeMode.png[[.fig--title-label]##Figure 2. ##Элемент «Список файлов» при перетаскивании файла]
*** вид при запрещенном добавлении дополнительных файлов:
+
image::attachFileInOnlyMainFileSelectTypeMode.png[[.fig--title-label]##Figure 3. ##Элемент «Список файлов» при перетаскивании файла]
+
«Бросьте» файл в раздел «Основные файлы» или, если разрешено, в «Дополнительные файлы».
+
После добавления файла или файлов элемент «Список файлов» примет вид списка файлов:

image::fileList_withdata_editmode.png[[.fig--title-label]##Figure 4. ##Элемент «Список файлов» с выбранными файлами]

Если возможность добавления дополнительных файлов отключена, элемент «Список файлов» не разделяется на области основных и дополнительных файлов; в заголовке элемента отображается количество приложенных основных файлов.

image::attachFileInOnlyMainFileShowMode.png[[.fig--title-label]##Figure 5. ##Элемент «Список файлов» с выбранными файлами с запрещенным добавлением дополнительных файлов]
* *Добавление файлов со сканера.* Элемент управления предоставляет возможность добавлять файлы со сканера, если:
. Функция активирована при настройке {wc}а.
. Пользователь работает на персональном компьютере с операционной системой Windows.
. Установлена и запущена программа xref:Install__DVWebTool_.adoc[_DVWebTool_].
. На компьютере зарегистрирован совместимый сканер (любой WIA или TWAIN-сканер).
+
Для добавления файла со сканера:

. Нажмите кнопку image:buttons/attachFileFromScan.png[Отсканированный документ] и щелкните по типу добавляемого файла: «основной» или, если разрешено, «дополнительный». Будет открыто окно сканирования.
+
image::attachFileScanMode.png[[.fig--title-label]##Figure 6. ##Окно сканирования]
. Выберите используемый сканер в списке «Сканер».
. Настройте параметры сканирования:
[loweralpha]
.. Выберите разрешение сканера из списка доступных. Чем выше разрешение, тем лучше качество изображения, но тяжелее файл.
.. Выберите цветность получаемого изображения: цветное, черно-белое, оттенки серого.
+
Параметры сканирования сохраняются в браузере и устанавливаются автоматически при следующем открытии окна сканирования.
. Если требуется предварительно оценить сканируемый документ, нажмите кнопку «Предпросмотр». После завершения сканирования в области предварительного просмотра появится изображение.
. В зависимости от количества сканируемых страниц нажмите кнопку:
** «Сканировать страницу» -- если нужно отсканировать только один лист,
** «Сканировать несколько страниц» -- если сканируемый документ содержит несколько листов. Возможность потокового сканирования должна поддерживаться сканером.
+
После сканирования можно:

** поворачивать изображение с помощью кнопок image:buttons/scanRotate.png[Повернуть документ],
** изменять масштаб и переключаться между страницами просмотра.
. Укажите название файла, с которым он будет добавлен в карточку.
. Выберите тип файла: PDF или JPEG. Если сканируется несколько страниц, будет использоваться формат PDF.
. Нажмите кнопку «Сохранить». Файл будет добавлен в карточку.
* *Изменение типа файла.* Для изменения типа добавленного файла (основной, дополнительный), удерживая строчку файла мышью, перетащите его в область файлов другого типа: из основных в дополнительные, или наоборот.
+
image::fileList_changefiletype.png[[.fig--title-label]##Figure 7. ##Изменение типа файла]
+
Если возможность добавления дополнительных файлов отключена, изменить тип файла описанным образом нельзя.
* *Переименование файлов*. Для изменения имени файла:
. Нажмите [.ph .menucascade]#*image:buttons/verticalDots.png[Три вертикальные точки]* > *Переименовать*# в строке файла.
+
Если файл заблокирован или отсутствуют права на изменение имени файла (операция «Переименование файлов»), функция переименования будет недоступна.
. Введите новое имя в открывшийся окне.
+
image::fileList_changename.png[[.fig--title-label]##Figure 8. ##Изменение имени файла]
+
Название файла не может содержать символы: «*», «/», «\», «|», «<», «>», «“», «?», «:». При попытке сохранения имени с запрещенными символами будет выдана ошибка «Заданное имя не является допустимым именем файла».
+
Также не может быть указано имя другого существующего файла карточки.
. Нажмите кнопку *OK*. Будет создана новая версия файла с указанным именем -- файлы в существующих версиях не переименовываются. Если имя файла не изменилось -- новая версия не создаётся.
+
Функция «Переименовать» не может быть использована для изменения расширения файла.
* *Удаление файлов.* Для удаления файла из карточки:
** при создании/редактировании карточки: нажмите кнопку image:buttons/removeItemFromList.png[Крестик] в строке удаляемого файла. Удаляемый файл, а также его карточка должны быть разблокированы.
** при просмотре карточки: нажмите [.ph .menucascade]#*image:buttons/verticalDots.png[Три вертикальные точки]* > *Удалить*# в строке файла. Удаление нужно подтвердить.
+
При удалении будут удалены все версии данного файла.
+
*Следующие функции доступны только при открытии карточки в режиме просмотра.*
* *Открытие файла*. Для открытия файла в связанной программе нажмите [.ph .menucascade]#*image:buttons/verticalDots.png[Три вертикальные точки]* > *Открыть*# в строке файла. Данная возможность доступна только для файлов Microsoft Office (*программы должны быть установлены*): doc, docx, docm, xls, xlsx, xlsm, ppt, pptx, odt и ods. Дополнительные файлы открываются в режиме чтения; основные файлы, доступные для редактирования -- в режиме редактирования. Открытый для редактирования файл будет заблокирован от изменений со стороны других пользователей. При сохранении файла с изменениями будет создана его новая версия.
+
Условия:

** До завершения редактирования файла не закрывайте карточку, из которой он был открыт.
** Если требуется запускать веб-браузер от имени не текущего пользователя Windows, используйте только Internet Explorer.
* *Предварительный просмотр*. Щелкните по названию файла, чтобы открыть его в режиме предварительного просмотра. Инструкция по работе с компонентом предпросмотра приведена в пункте xref:FilePreview.adoc[Предпросмотр файла].
* *Скачивание файла.* Для сохранения файла карточки на компьютер нажмите [.ph .menucascade]#*image:buttons/verticalDots.png[Три вертикальные точки]* > *Скачать*# в строке файла.
* *Блокировка/разблокировка основного файла.* Основой файл может быть временно заблокирован для защиты от изменений со стороны других пользователей. Для блокировки (разблокировки) файла нажмите [.ph .menucascade]#*image:buttons/verticalDots.png[Три вертикальные точки]* > *Заблокировать (Разблокировать)*# в строке файла. Заблокированный файлы выделяются розовой заливкой фона.
* *Просмотр версий основного файла.* Текущая версия файла отображается в основной области списка файлов. Номер текущей версии указывается справа от названия файла (на рисунке -- «в.1»).
+
image::mainFileCurrentVersion.png[[.fig--title-label]##Figure 9. ##Текущая версия файла]
+
Для просмотра других версий файла щелкните по номеру текущей версии (на рисунке -- «в. 2»). Для версии указываются номер, автор и дата создания (добавления файла).
+
image::mainFileVersions.png[[.fig--title-label]##Figure 10. ##Список версий файла]
* *Загрузка новой версии основного файла.* Для загрузки новой версии файла нажмите [.ph .menucascade]#*image:buttons/verticalDots.png[Три вертикальные точки]* > *Загрузить версию*# в строке файла и выберите новую версию файла из файловой системы. Название и тип файла новой версии может отличаться от существующей -- все существующие версии остаются без изменений. После загрузки версии номер текущей версии увеличится.
+
image::mainFileNewCurrentVersion.png[[.fig--title-label]##Figure 11. ##Новая версия файла]
* *Скачивание версии основного файла.* Для сохранения определенной версии файла на компьютер откройте список версий и нажмите кнопку image:buttons/butt_load.png[Скачать] в строке скачиваемой версии.
* *Редактирование файла.* Способ изменения файла зависит от его типа:
** для редактирования основного файла нужно скачать его на компьютер, внести изменения в скаченный файл и загрузить его новую версию в карточку;
** для редактирования основного файла формата Microsoft Office можно открыть его из меню (см. выше), внести изменения и закрыть с сохранением;
** для редактирования дополнительного нужно скачать его на компьютер, внести изменения в скаченный файл, удалить данный файл из карточки и загрузить измененный файл в карточку.
* *Подписание файлов.* Для подписания файлов нажмите [.ph .menucascade]#*image:buttons/butt_sing_file.png[Прозрачная печать]* > *Подписать*# и выберите вид подписи и сертификат электронной подписи (для квалифицированной подписи). См. подробности в пункте xref:task_dcard_file_signature_add.adoc[Произвольное подписание документов].
* *Выгрузка файлов с электронными подписями.* Для выгрузки подписанных основных файлов вместе с электронными подписями нажмите image:buttons/exportFilesWithSign.png[Файлы с прозрачной печатью]. См. подробности в пункте xref:ExportFilesWithSign.adoc[Выгрузка файлов с подписями].
* *Загрузка отсоединённой электронной подписи*. Для загрузки отсоединённой электронной подписи основного файла нажмите [.ph .menucascade]#*image:buttons/verticalDots.png[Три вертикальные точки]* > *Загрузить ЭП*# в строке файла и выберите новую файл отсоединённой подписи (поддерживаются форматы P7S, SIGN, SGN или SIG). См. подробности в пункте xref:LoadingDetachedSignature.adoc[Загрузка отсоединённой электронной подписи файла].


xref:#fnsrc_1[^1^] Для возможности загрузки файлов .ascx, .cs и .java требуется дополнительная настройка. См. пункт Руководство администратора.
