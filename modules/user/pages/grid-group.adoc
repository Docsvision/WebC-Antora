= Группировка

:func: группировки
:cnt: Сгруппировать по столбцу
include::partial$excerpts.adoc[tags=unv]

[CAUTION]
====
Группировка значений доступна только для REST. Если {wc} работает через COM, дополнительная область группировок и кнопка её включения не отображаются и группировка недоступна.
====

:func: group
:rus: "Группировка"
include::partial$excerpts.adoc[tags=availability]

Количество группируемых колонок не ограниченно. При создании группировки сначала происходит группировка по первой колонке, затем, уже внутри групп -– по второй и т. д.

== Работа с группировками в представлении

.Грид с дополнительной областью группировки
image::group.png[Грид с дополнительной областью группировки]

.Если группировка настроена в РМА:
* При открытии грида дополнительная область группировок отображается всегда вне зависимости от xref:layouts:ctrl/folderComponents/folderGrid_FolderGridToolbar.adoc[настроек панели управления грида].
* Удалять или добавлять группы можно, только если в настойках xref:layouts:ctrl/folderComponents/folderGrid_FolderGridToolbar.adoc[панели управления грида] разрешена группировка.

.Если группировка разрешена в настойках ЭУ xref:layouts:ctrl/folderComponents/folderGrid.adoc#group["Карточки папки"], но не настроена в РМА:
. Группировка отображается в дополнительной области слева от грида. Дополнительная область по умолчанию скрыта и может быть отображена нажатием кнопки на панели управления гридом.
+
.Кнопка отображения области группировок
image::group-button.png[Кнопка отображения области группировок]
+
. Чтобы применить группировку, перетащите заголовок колонки из области грида в дополнительную область. В дополнительной области отобразится название группы -- имя колонки представления. Перетащить можно один или несколько заголовков.
+
.Область группировки
image::group-area.png[Область группировки]
+
. Напротив каждой группы отображается количество карточек. Чтобы перейти с одной группы на другую, нажмите на строку группы в дополнительной области. При этом текущий набор карточек в гриде будет заменён карточками выбранной группы.
+
.Группировка по столбцу "Подразделения"
image::group-engaged.png[Группировка по столбцу "Подразделения"]
+
. При выбранной группировке колонки, кроме сгруппированных, могут скрываться.
+
****
Колонки будут скрыты, когда группировка настроена в РМА.

Отменить скрытие колонок можно в РМА: флаг menu:Представления[Представление > Установки > Не скрывать группируемые колонки].
****
+
. Чтобы сбросить группировку, нажмите на крест в области группировок.
+
.Кнопка сброса группировки в дополнительной области
image:reset-group.png[Кнопка сброса группировки в дополнительной области].
+
. Чтобы убрать только одну колонку из группировки, перетащите её заголовок из дополнительной области в свободную область {wc}а.
+
.Разгруппировка
image::ungroup.png[Разгруппировка]
+
Если удалить одну из колонок группировки, в представлении колонка вернётся в последнее сохранённое положение.
+
Если удалить центральную колонку (например, в группе из трёх), она будет встроена обратно в грид. При этом группировка по оставшимся колонкам сохранится.

== Взаимодействие с другими функциями грида

=== Сортировка

. Если применяется группировка по колонке с xref:grid-sort.adoc[сортировкой], сортировка колонки переносится на группы. Внутри каждой группы сортировка может быть настроена отдельно.
. Если группировка применяется к колонке без сортировки, группы сортируются во возрастанию (от меньшего к большему, от А до Я).
+
. Для колонки, встроенной обратно в грид будет сохранена последняя сортировка. Например, если было 4 столбца и сортировка по 2-ому столбцу, то при возврате в грид 5 столбца, сортировка продолжает быть по 2-ому столбцу.
+
TIP: Колонки будут скрыты и возвращены в грид только, если группировка включена в РМА.
+
. При полном сбросе группировки карточки отсортированы по последней примененной сортировке.

//=== Агрегаты
//
//Группировка не работает в папке, где используются xref:grid-aggregate.adoc[агрегаты].

=== Фильтры

Если осуществляется группировка по колонке, к которой был применен фильтр, то при группировке фильтр с этой колонки сбрасывается. Для остальных колонок фильтры остаются.

//Если осуществляется группировка по колонке, к которой был применен фильтр, то при группировке фильтр с этой колонки сбрасывается. При этом после применения группировки фокус остаётся на той группе, по значению которой была фильтрация.
//
//****
//Например, если был использован фильтр по колонке _Исполнитель_ со значением _Иванов_, после группировки получаем группы: _Иванов_, _Петров_, _Сидоров_ и т.д. с фокусом на группе _Иванов_.
//****

=== Поиск в папке

Если настроена группировка, поиск в папке осуществляется по группам. То есть после поиска в каждой группе выводятся только карточки, соответствующие критериям поиска

=== Индикация количества карточек

.Количество карточек в группе
image::card-count-group.png[Количество карточек в группе]

include::partial$excerpts.adoc[tags=count]

== Постраничная проверка прав

. Если группировка была включена по умолчанию в папке с постраничной проверкой прав, данные папки могут загружаться дольше.
. Если пользователь самостоятельно применяет группировку в папке с настроенной постраничной проверкой прав, операцию необходимо подтвердить.
+
include::partial$excerpts.adoc[tags=confirm]
+
. Если пользователь переключает представление по умолчанию на представление с группировкой и постраничной проверкой прав, действие необходимо подтвердить.
+
include::partial$excerpts.adoc[tags=confirm]
