
== Предпросмотр файла

Компонент "Предпросмотр файла" позволяет просматривать содержимое файла карточки без его открытия во внешнем приложении и скачивания на устройство. Из режима предпросмотра документ можно отправить на печать. Возможность печати ограничена для браузеров Internet Explorer и Edge (до перехода на Chromium в версии 79). При печати из этих браузеров в конечном документе могут быть лишние листы и записи. Для корректной печати используйте более современные браузеры.

{wc} предоставляет два варианта предпросмотра файлов (определяется при настройке {wc}а):

* В отдельном всплывающем окне:
+
image::filesPreview.png[Предварительный просмотр файла]
* Непосредственно в разметке карточки:
+
image::filePreview.png[Предварительный просмотр]

*Открытие предпросмотра файла*. Для предварительного просмотра содержимого файла выберите его в списке файлов карточки.

Для компонента "Предпросмотр файла", встроенного в разметку, также доступна возможность выбора просматриваемого файла из списка в самом компоненте. При этом файл также выборе файла в компоненте "Предпросмотр файла", он также будет выделен в списке файлов карточки.

image::filePreviewFiles.png[Список файлов]

Предварительный просмотр поддерживается для следующих типов файлов:

* pdf;
* офисныеfootnote:[В режиме предпросмотра не поддерживается выполнение макросов в файлах docm, dotm, xltm и xlsm.]: docx, odt, doc, rtf, dot, docm, dotm, dotx, xlt, xls, xltm, xlsm, xltx, xlsx, ods;
* изображения: jpg, jpeg, gif, png, bmp, tiff, tif, emf, wmf;
* прочие: htm, html, js, xslt, xsl, xml, asmx, ascx, aspx, cpp, h, css, idl, ini, java, rc, rc2, shtm, shtml, txt, log, cs, sql, csv.

Если формат файла не поддерживается, будет предоставлена ссылка для его сохранения на компьютер пользователя.

image::filePreviewNotSupport.png[Предпросмотр неподдерживаемого типа файла]

При предпросмотре текстовых файлов (с расширением TXT) отображаются только первые 100 000 символов. Если файл содержит большее количество символов -- в предпросмотр будет добавлена строка "Полный предпросмотр данный файла недоступен по причине большого размера, -- сохраните текстовый файл на устройство и откройте его в стандартном средстве просмотра.

*Комментирование*. Если предпросмотр открывается в отдельном окне, область комментариев будет доступна сразу. Для комментирования файла в компоненте "Предпросмотр файла", встроенном в разметку, нажмите image:buttons/showCommentsInfilePreview.png[Комментарии]/image:buttons/showCommentsInfilePreviewWithComment.png[Иконка комментарии с синей точкой] (если есть комментарии). Закрыть блок комментирования можно повторным нажатием кнопки image:buttons/showCommentsInfilePreview.png[Комментарии] или клавишей *Escape*.

image::filePreviewComments.png[Комментирование файла]

Данный блок комментариев можно перетаскивать с помощью мыши.

[NOTE]
====
[.note__title]#Note:# Информация по работе с компонентом комментариев приведена в пункте xref:Comments.adoc[Комментарии].
====

*Поиск по документу*. Нажмите кнопку image:buttons/searchPreview.png[Лупа] на панели инструментов и введите искомый текст в поле поиска.

image::filePreviewSearch.png[image]

Поиск возможен только при просмотре текстового документа.

*Изменение масштаба*. Для изменения масштаба документа используйте кнопки *-* / *+* или список справа от кнопок.

Для компонента "Предпросмотр файла", встроенного в разметку, также доступна возможность расширения области предпросмотра. Для этого наведите курсор мыши в зону разделения предпросмотра и данных карточки -- форма курсора изменится. Потяните "разделитель" вправо или влево для изменения ширины области предпросмотра.

image::filePreviewChangeWidth.png[Изменение ширины области предпросмотра]

*Другие функции предпросмотра*. Компонент предпросмотра также предоставляет другие функции (печать, сохранение документа и др.). Нажмите кнопку image:buttons/filePreviewCommandsExpander.png[Двойная стрелка-галочка вправо] для открытия полного списка доступных команд.

[NOTE]
====
[.note__title]#Note:# При работе в Microsoft Internet Explorer и Microsoft Edge (не на базе Chromium) функция печати из компонента предпросмотра может работать с ошибкой (например, печать дополнительных пустых страниц). В данном случае рекомендуется воспользоваться более современным браузером (из списка совместимых с {wc}ом) или распечатать документ из внешнего приложения.
====
